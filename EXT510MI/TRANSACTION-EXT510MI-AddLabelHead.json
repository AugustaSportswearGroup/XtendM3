{"programModules":{"EXT510MI":{"program":"EXT510MI","triggers":{},"transactions":{"AddLabelHead":{"sourceUuid":"ce878218-6bc2-44fd-86b4-750b22b64a6f","name":"AddLabelHead","program":"EXT510MI","description":"Add Label Header Information","active":true,"multi":false,"modified":1700803016209,"modifiedBy":"M3CONSADMX","outputFields":[],"inputFields":[{"name":"CONO","description":"Company Number","length":3,"mandatory":false,"type":"N"},{"name":"DIVI","description":"Division","length":3,"mandatory":false,"type":"A"},{"name":"FACI","description":"Facility","length":3,"mandatory":false,"type":"A"},{"name":"WHLO","description":"Warehouse","length":3,"mandatory":true,"type":"A"},{"name":"PYCU","description":"Customer Number","length":10,"mandatory":false,"type":"A"},{"name":"SPOC","description":"Payer or Customer","length":1,"mandatory":false,"type":"A"},{"name":"DLIX","description":"Delivery Number","length":11,"mandatory":true,"type":"N"},{"name":"IVNO","description":"Invoice Number","length":9,"mandatory":false,"type":"N"},{"name":"RIDN","description":"Order Number","length":10,"mandatory":true,"type":"A"},{"name":"RIDL","description":"Order Line Number","length":6,"mandatory":true,"type":"N"},{"name":"ITNO","description":"Item Number","length":15,"mandatory":false,"type":"A"},{"name":"SPID","description":"ASN Shipment ID","length":18,"mandatory":false,"type":"A"},{"name":"CSID","description":"Case ID","length":18,"mandatory":false,"type":"A"},{"name":"GTIN","description":"GTIN","length":14,"mandatory":false,"type":"A"},{"name":"BXNO","description":"Box Number","length":4,"mandatory":false,"type":"N"},{"name":"QUAN","description":"Quantity","length":7,"mandatory":false,"type":"N"},{"name":"BANO","description":"Lot Number","length":12,"mandatory":false,"type":"A"},{"name":"UDF1","description":"User Defined Field 1","length":30,"mandatory":false,"type":"A"},{"name":"UDF2","description":"User Defined Field 2","length":10,"mandatory":false,"type":"N"},{"name":"UDF3","description":"User Defined Field 3","length":15,"mandatory":false,"type":"N"},{"name":"UDF4","description":"User Defined Field 4","length":1,"mandatory":false,"type":"A"}],"utilities":[]}},"batches":{},"advancedPrograms":{}}},"utilities":{},"sources":{"ce878218-6bc2-44fd-86b4-750b22b64a6f":{"uuid":"ce878218-6bc2-44fd-86b4-750b22b64a6f","updated":1700811289063,"updatedBy":"M3CONSADMX","created":1692267457717,"createdBy":"M3CONSADMX","apiVersion":"0.21","beVersion":"16.0.0.20230918173517.7","language":"GROOVY","codeHash":"AF807774C36A10BA3C312574A660B0406BF93DCE760F94F5EB784384F792283E","code":"LyoqCiAqIFJFQURNRQogKiBUaGlzIGV4dGVuc2lvbiBpcyBiZWluZyB1c2VkIHRvIEFkZCByZWNvcmRzIHRvIEVYVFNNRiB0YWJsZS4gCiAqCiAqIE5hbWU6IEVYVDUxME1JLkFkZExhYmVsSGVhZAogKiBEZXNjcmlwdGlvbjogQWRkaW5nIHJlY29yZHMgdG8gRVhUU01GIHRhYmxlIAogKiBEYXRlCSAgICAgIENoYW5nZWQgQnkgICAgICAgICAgICAgICAgICAgICAgRGVzY3JpcHRpb24KICoyMDIzMDgxNyAgU3VyaXlhTkBmb3J0dWRlLmNvICAgICBBZGRpbmcgcmVjb3JkcyB0byBFWFRTTUYgdGFibGUgKi8KCmltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlVGltZQppbXBvcnQgamF2YS50aW1lLmZvcm1hdC5EYXRlVGltZUZvcm1hdHRlcgoKcHVibGljIGNsYXNzIEFkZExhYmVsSGVhZCBleHRlbmRzIEV4dGVuZE0zVHJhbnNhY3Rpb24gewogIHByaXZhdGUgZmluYWwgTUlBUEkgbWkKICBwcml2YXRlIGZpbmFsIERhdGFiYXNlQVBJIGRhdGFiYXNlCiAgcHJpdmF0ZSBmaW5hbCBQcm9ncmFtQVBJIHByb2dyYW0KICBwcml2YXRlIGZpbmFsIE1JQ2FsbGVyQVBJIG1pQ2FsbGVyCgogIHByaXZhdGUgU3RyaW5nIGlESVZJLCBpUklETiwgaUZBQ0ksIGlXSExPLCBpUFlDVSwgaVNQT0MsIGlJVE5PLCBpU1BJRCwgaUNTSUQsIGlHVElOLCBpQkFOTywgaVVERjEsIGlVREY0CiAgcHJpdmF0ZSBpbnQgaUNPTk8sIGlSSURMLCBpSVZOTywgaUJYTk8sIGlRVUFOLCBpVURGMiwgaVVERjMKICBwcml2YXRlIGxvbmcgaURMSVgKICBib29sZWFuIHZhbGlkSW5wdXQgPSB0cnVlCgogIHB1YmxpYyBBZGRMYWJlbEhlYWQoTUlBUEkgbWksIERhdGFiYXNlQVBJIGRhdGFiYXNlLCBQcm9ncmFtQVBJIHByb2dyYW0sIE1JQ2FsbGVyQVBJIG1pQ2FsbGVyKSB7CiAgICB0aGlzLm1pID0gbWkKICAgIHRoaXMuZGF0YWJhc2UgPSBkYXRhYmFzZQogICAgdGhpcy5wcm9ncmFtID0gcHJvZ3JhbQogICAgdGhpcy5taUNhbGxlciA9IG1pQ2FsbGVyCiAgfQogIC8qKgogICAqKiBNYWluIGZ1bmN0aW9uCiAgICogQHBhcmFtCiAgICogQHJldHVybgogICAqLwogIHB1YmxpYyB2b2lkIG1haW4oKSB7CiAgICBpRElWSSA9IChtaS5pbkRhdGEuZ2V0KCJESVZJIikgPT0gbnVsbCB8fCBtaS5pbkRhdGEuZ2V0KCJESVZJIikudHJpbSgpLmlzRW1wdHkoKSkgPyBwcm9ncmFtLkxEQVpELkRJVkkgOiBtaS5pbkRhdGEuZ2V0KCJESVZJIikKICAgIGlXSExPID0gKG1pLmluRGF0YS5nZXQoIldITE8iKSA9PSBudWxsIHx8IG1pLmluRGF0YS5nZXQoIldITE8iKS50cmltKCkuaXNFbXB0eSgpKSA/ICIiIDogbWkuaW5EYXRhLmdldCgiV0hMTyIpCiAgICBpUklETiA9IChtaS5pbkRhdGEuZ2V0KCJSSUROIikgPT0gbnVsbCB8fCBtaS5pbkRhdGEuZ2V0KCJSSUROIikudHJpbSgpLmlzRW1wdHkoKSkgPyAiIiA6IG1pLmluRGF0YS5nZXQoIlJJRE4iKQogICAgaUZBQ0kgPSAobWkuaW5EYXRhLmdldCgiRkFDSSIpID09IG51bGwgfHwgbWkuaW5EYXRhLmdldCgiRkFDSSIpLnRyaW0oKS5pc0VtcHR5KCkpID8gIiIgOiBtaS5pbkRhdGEuZ2V0KCJGQUNJIikKICAgIGlQWUNVID0gKG1pLmluRGF0YS5nZXQoIlBZQ1UiKSA9PSBudWxsIHx8IG1pLmluRGF0YS5nZXQoIlBZQ1UiKS50cmltKCkuaXNFbXB0eSgpKSA/ICIiIDogbWkuaW5EYXRhLmdldCgiUFlDVSIpCiAgICBpU1BPQyA9IChtaS5pbkRhdGEuZ2V0KCJTUE9DIikgPT0gbnVsbCB8fCBtaS5pbkRhdGEuZ2V0KCJTUE9DIikudHJpbSgpLmlzRW1wdHkoKSkgPyAiMCIgOiBtaS5pbkRhdGEuZ2V0KCJTUE9DIikKICAgIGlJVE5PID0gKG1pLmluRGF0YS5nZXQoIklUTk8iKSA9PSBudWxsIHx8IG1pLmluRGF0YS5nZXQoIklUTk8iKS50cmltKCkuaXNFbXB0eSgpKSA/ICIiIDogbWkuaW5EYXRhLmdldCgiSVROTyIpCiAgICBpU1BJRCA9IChtaS5pbkRhdGEuZ2V0KCJTUElEIikgPT0gbnVsbCB8fCBtaS5pbkRhdGEuZ2V0KCJTUElEIikudHJpbSgpLmlzRW1wdHkoKSkgPyAiIiA6IG1pLmluRGF0YS5nZXQoIlNQSUQiKQogICAgaUNTSUQgPSAobWkuaW5EYXRhLmdldCgiQ1NJRCIpID09IG51bGwgfHwgbWkuaW5EYXRhLmdldCgiQ1NJRCIpLnRyaW0oKS5pc0VtcHR5KCkpID8gIiIgOiBtaS5pbkRhdGEuZ2V0KCJDU0lEIikKICAgIGlHVElOID0gKG1pLmluRGF0YS5nZXQoIkdUSU4iKSA9PSBudWxsIHx8IG1pLmluRGF0YS5nZXQoIkdUSU4iKS50cmltKCkuaXNFbXB0eSgpKSA/ICIiIDogbWkuaW5EYXRhLmdldCgiR1RJTiIpCiAgICBpQkFOTyA9IChtaS5pbkRhdGEuZ2V0KCJCQU5PIikgPT0gbnVsbCB8fCBtaS5pbkRhdGEuZ2V0KCJCQU5PIikudHJpbSgpLmlzRW1wdHkoKSkgPyAiIiA6IG1pLmluRGF0YS5nZXQoIkJBTk8iKQogICAgaVVERjEgPSAobWkuaW5EYXRhLmdldCgiVURGMSIpID09IG51bGwgfHwgbWkuaW5EYXRhLmdldCgiVURGMSIpLnRyaW0oKS5pc0VtcHR5KCkpID8gIiIgOiBtaS5pbkRhdGEuZ2V0KCJVREYxIikKICAgIGlVREY0ID0gKG1pLmluRGF0YS5nZXQoIlVERjQiKSA9PSBudWxsIHx8IG1pLmluRGF0YS5nZXQoIlVERjQiKS50cmltKCkuaXNFbXB0eSgpKSA/ICIwIiA6IG1pLmluRGF0YS5nZXQoIlVERjQiKQoKICAgIGlDT05PID0gKG1pLmluRGF0YS5nZXQoIkNPTk8iKSA9PSBudWxsIHx8IG1pLmluRGF0YS5nZXQoIkNPTk8iKS50cmltKCkuaXNFbXB0eSgpKSA/IHByb2dyYW0uTERBWkQuQ09OTyBhcyBJbnRlZ2VyIDogbWkuaW5EYXRhLmdldCgiQ09OTyIpIGFzIEludGVnZXIKICAgIGlSSURMID0gKG1pLmluRGF0YS5nZXQoIlJJREwiKSA9PSBudWxsIHx8IG1pLmluRGF0YS5nZXQoIlJJREwiKS50cmltKCkuaXNFbXB0eSgpKSA/IDAgOiBtaS5pbkRhdGEuZ2V0KCJSSURMIikgYXMgSW50ZWdlcgogICAgaURMSVggPSAobWkuaW5EYXRhLmdldCgiRExJWCIpID09IG51bGwgfHwgbWkuaW5EYXRhLmdldCgiRExJWCIpLnRyaW0oKS5pc0VtcHR5KCkpID8gMCA6IG1pLmluRGF0YS5nZXQoIkRMSVgiKSBhcyBMb25nCiAgICBpSVZOTyA9IChtaS5pbkRhdGEuZ2V0KCJJVk5PIikgPT0gbnVsbCB8fCBtaS5pbkRhdGEuZ2V0KCJJVk5PIikudHJpbSgpLmlzRW1wdHkoKSkgPyAwIDogbWkuaW5EYXRhLmdldCgiSVZOTyIpIGFzIEludGVnZXIKICAgIGlVREYyID0gKG1pLmluRGF0YS5nZXQoIlVERjIiKSA9PSBudWxsIHx8IG1pLmluRGF0YS5nZXQoIlVERjIiKS50cmltKCkuaXNFbXB0eSgpKSA/IDAgOiBtaS5pbkRhdGEuZ2V0KCJVREYyIikgYXMgSW50ZWdlcgogICAgaVVERjMgPSAobWkuaW5EYXRhLmdldCgiVURGMyIpID09IG51bGwgfHwgbWkuaW5EYXRhLmdldCgiVURGMyIpLnRyaW0oKS5pc0VtcHR5KCkpID8gMCA6IG1pLmluRGF0YS5nZXQoIlVERjMiKSBhcyBJbnRlZ2VyCiAgICBpQlhOTyA9IChtaS5pbkRhdGEuZ2V0KCJCWE5PIikgPT0gbnVsbCB8fCBtaS5pbkRhdGEuZ2V0KCJCWE5PIikudHJpbSgpLmlzRW1wdHkoKSkgPyAwIDogbWkuaW5EYXRhLmdldCgiQlhOTyIpIGFzIEludGVnZXIKICAgIGlRVUFOID0gKG1pLmluRGF0YS5nZXQoIlFVQU4iKSA9PSBudWxsIHx8IG1pLmluRGF0YS5nZXQoIlFVQU4iKS50cmltKCkuaXNFbXB0eSgpKSA/IDAgOiBtaS5pbkRhdGEuZ2V0KCJRVUFOIikgYXMgSW50ZWdlcgoKICAgIHZhbGlkYXRlSW5wdXQoKQogICAgaWYgKHZhbGlkSW5wdXQpIHsKICAgICAgaW5zZXJ0UmVjb3JkKCkKICAgIH0KICB9CgogIC8qKgogICAqVmFsaWRhdGUgUmVjb3JkcwogICAqIEBwYXJhbXMKICAgKiBAcmV0dXJuIAogICAqLwogIHB1YmxpYyB2YWxpZGF0ZUlucHV0KCkgewoKICAgIC8vVmFsaWRhdGUgQ29tcGFueSBOdW1iZXIKICAgIGRlZiBwYXJhbXMgPSBbIkNPTk8iOiBpQ09OTy50b1N0cmluZygpLnRyaW0oKV0KICAgIGRlZiBjYWxsYmFjayA9IHsKICAgICAgTWFwIDwgU3RyaW5nLAogICAgICBTdHJpbmcgPiByZXNwb25zZSAtPgogICAgICBpZiAocmVzcG9uc2UuQ09OTyA9PSBudWxsKSB7CiAgICAgICAgbWkuZXJyb3IoIkludmFsaWQgQ29tcGFueSBOdW1iZXIgIiArIGlDT05PKQogICAgICAgIHZhbGlkSW5wdXQgPSBmYWxzZQogICAgICAgIHJldHVybiBmYWxzZQogICAgICB9CiAgICB9CiAgICBtaUNhbGxlci5jYWxsKCJNTlMwOTVNSSIsICJHZXQiLCBwYXJhbXMsIGNhbGxiYWNrKQogICAgCiAgICAvL1ZhbGlkYXRlIERpdmlzaW9uIAogICAgaWYoIWlESVZJLnRyaW0oKS5pc0VtcHR5KCkpCiAgICB7CiAgICAgICAgLy9WYWxpZGF0ZSBJbnZvaWNlIE51bWJlcgogICAgICBEQkFjdGlvbiBhY3Rpb24gPSBkYXRhYmFzZS50YWJsZSgiQ01ORElWIikuaW5kZXgoIjAwIikuYnVpbGQoKQogICAgICBEQkNvbnRhaW5lciBxdWVyeSA9IGFjdGlvbi5nZXRDb250YWluZXIoKQogICAgICBxdWVyeS5zZXQoIkNDQ09OTyIsIGlDT05PKQogICAgICBxdWVyeS5zZXQoIkNDRElWSSIsIGlESVZJKQogICAgICBpZiAoIWFjdGlvbi5yZWFkKHF1ZXJ5KSkgewogICAgICAgIG1pLmVycm9yKCJEaXZpc2lvbiBkb2VzIG5vdCBleGlzdC4iKQogICAgICAgIHZhbGlkSW5wdXQgPSBmYWxzZQogICAgICAgIHJldHVybiBmYWxzZQogICAgICB9CiAgICB9CiAgICAKICAgIAogICAgaWYgKCFpSVROTy50cmltKCkuaXNFbXB0eSgpKSB7CiAgICAgIC8vVmFsaWRhdGUgSXRlbSBOdW1iZXIKICAgICAgcGFyYW1zID0gWyJDT05PIjogaUNPTk8udG9TdHJpbmcoKS50cmltKCksICJJVE5PIjogaUlUTk8udG9TdHJpbmcoKS50cmltKCldCiAgICAgIGNhbGxiYWNrID0gewogICAgICAgIE1hcCA8IFN0cmluZywKICAgICAgICBTdHJpbmcgPiByZXNwb25zZSAtPgogICAgICAgIGlmIChyZXNwb25zZS5JVE5PID09IG51bGwpIHsKICAgICAgICAgIG1pLmVycm9yKCJJbnZhbGlkIEl0ZW0gTnVtYmVyICIgKyBpSVROTykKICAgICAgICAgIHZhbGlkSW5wdXQgPSBmYWxzZQogICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgfQogICAgICB9CiAgICAgIAogICAgbWlDYWxsZXIuY2FsbCgiTU1TMjAwTUkiLCAiR2V0IiwgcGFyYW1zLCBjYWxsYmFjaykKICAgIH0KCiAgICBpZiAoIWlGQUNJLnRyaW0oKS5pc0VtcHR5KCkpIHsKICAgICAgLy9WYWxpZGF0ZSBGYWNpbGl0eSBOdW1iZXIKICAgICAgcGFyYW1zID0gWyJDT05PIjogaUNPTk8udG9TdHJpbmcoKS50cmltKCksICJGQUNJIjogaUZBQ0kudG9TdHJpbmcoKS50cmltKCldCiAgICAgIGNhbGxiYWNrID0gewogICAgICAgIE1hcCA8IFN0cmluZywKICAgICAgICBTdHJpbmcgPiByZXNwb25zZSAtPgogICAgICAgIGlmIChyZXNwb25zZS5GQUNJID09IG51bGwpIHsKICAgICAgICAgIG1pLmVycm9yKCJJbnZhbGlkIEZhY2lsaXR5IE51bWJlciAiICsgaUZBQ0kpCiAgICAgICAgICB2YWxpZElucHV0ID0gZmFsc2UKICAgICAgICAgIHJldHVybiBmYWxzZQogICAgICAgIH0KICAgICAgfQogICAgICBtaUNhbGxlci5jYWxsKCJDUlMwMDhNSSIsICJHZXQiLCBwYXJhbXMsIGNhbGxiYWNrKQogICAgfQoKICAgIGlmICghaVJJRE4udHJpbSgpLmlzRW1wdHkoKSkgewogICAgICAvL1ZhbGlkYXRlIE9yZGVyIE51bWJlciBPcmRlciBMaW5lIGNvbWJvCiAgICAgIHBhcmFtcyA9IFsiQ09OTyI6IGlDT05PLnRvU3RyaW5nKCkudHJpbSgpLCAiT1JOTyI6IGlSSUROLnRvU3RyaW5nKCkudHJpbSgpLCAiUE9OUiI6IGlSSURMLnRvU3RyaW5nKCkudHJpbSgpXQogICAgICBjYWxsYmFjayA9IHsKICAgICAgICBNYXAgPCBTdHJpbmcsCiAgICAgICAgU3RyaW5nID4gcmVzcG9uc2UgLT4KICAgICAgICBpZiAocmVzcG9uc2UuSVROTyA9PSBudWxsKSB7CiAgICAgICAgICB2YWxpZElucHV0ID0gZmFsc2UKICAgICAgICB9CiAgICAgIH0KICAgICAgbWlDYWxsZXIuY2FsbCgiT0lTMTAwTUkiLCAiR2V0TGluZSIsIHBhcmFtcywgY2FsbGJhY2spCgogICAgICAvL0lmIG5vdCBDTywgY2hlY2sgaWYgdmFsaWQgRE8KICAgICAgaWYgKCF2YWxpZElucHV0KSB7CiAgICAgICAgdmFsaWRJbnB1dCA9IHRydWUKICAgICAgICBwYXJhbXMgPSBbIkNPTk8iOiBpQ09OTy50b1N0cmluZygpLnRyaW0oKSwgIlRSTlIiOiBpUklETi50b1N0cmluZygpLnRyaW0oKSwgIlBPTlIiOiBpUklETC50b1N0cmluZygpLnRyaW0oKV0KICAgICAgICBjYWxsYmFjayA9IHsKICAgICAgICAgIE1hcCA8IFN0cmluZywKICAgICAgICAgIFN0cmluZyA+IHJlc3BvbnNlIC0+CiAgICAgICAgICBpZiAocmVzcG9uc2UuSVROTyA9PSBudWxsKSB7CiAgICAgICAgICAgIG1pLmVycm9yKCJJbnZhbGlkIE9yZGVyIE51bWJlciAtIE9yZGVyIExpbmUgIiArIGlSSUROKQogICAgICAgICAgICB2YWxpZElucHV0ID0gZmFsc2UKICAgICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIG1pQ2FsbGVyLmNhbGwoIk1NUzEwME1JIiwgIkdldEhlYWQiLCBwYXJhbXMsIGNhbGxiYWNrKQogICAgICB9CiAgICB9CgogICAgLy9WYWxpZGF0ZSBEZWxpdmVyeSBOdW1iZXIKICAgIHBhcmFtcyA9IFsiQ09OTyI6IGlDT05PLnRvU3RyaW5nKCkudHJpbSgpLCAiRExJWCI6IGlETElYLnRvU3RyaW5nKCkudHJpbSgpXQogICAgY2FsbGJhY2sgPSB7CiAgICAgIE1hcCA8IFN0cmluZywKICAgICAgU3RyaW5nID4gcmVzcG9uc2UgLT4KICAgICAgaWYgKHJlc3BvbnNlLkRMSVggPT0gbnVsbCkgewogICAgICAgIG1pLmVycm9yKCJJbnZhbGlkIERlbGl2ZXJ5IE51bWJlciAiICsgaURMSVgpCiAgICAgICAgdmFsaWRJbnB1dCA9IGZhbHNlCiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgIH0KICAgIH0KICAgIG1pQ2FsbGVyLmNhbGwoIk1XUzQxME1JIiwgIkdldEhlYWQiLCBwYXJhbXMsIGNhbGxiYWNrKQoKICAgIGlmICghaVdITE8udHJpbSgpLmlzRW1wdHkoKSkgewogICAgICAvL1ZhbGlkYXRlIFdhcmVob3VzZSBOdW1iZXIKICAgICAgcGFyYW1zID0gWyJDT05PIjogaUNPTk8udG9TdHJpbmcoKS50cmltKCksICJXSExPIjogaVdITE8udG9TdHJpbmcoKS50cmltKCldCiAgICAgIGNhbGxiYWNrID0gewogICAgICAgIE1hcCA8IFN0cmluZywKICAgICAgICBTdHJpbmcgPiByZXNwb25zZSAtPgogICAgICAgIGlmIChyZXNwb25zZS5XSExPID09IG51bGwpIHsKICAgICAgICAgIG1pLmVycm9yKCJJbnZhbGlkIFdhcmVob3VzZSBOdW1iZXIgIiArIGlXSExPKQogICAgICAgICAgdmFsaWRJbnB1dCA9IGZhbHNlCiAgICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgICB9CiAgICAgIH0KICAgICAgbWlDYWxsZXIuY2FsbCgiTU1TMDA1TUkiLCAiR2V0V2FyZWhvdXNlIiwgcGFyYW1zLCBjYWxsYmFjaykKICAgIH0KCiAgICBpZiAoIWlCQU5PLnRyaW0oKS5pc0VtcHR5KCkpIHsKICAgICAgLy9WYWxpZGF0ZSBMb3QgTnVtYmVyCiAgICAgIHBhcmFtcyA9IFsiQ09OTyI6IGlDT05PLnRvU3RyaW5nKCkudHJpbSgpLCAiQkFOTyI6IGlCQU5PLnRvU3RyaW5nKCkudHJpbSgpLCAiSVROTyI6IGlJVE5PLnRvU3RyaW5nKCkudHJpbSgpXQogICAgICBjYWxsYmFjayA9IHsKICAgICAgICBNYXAgPCBTdHJpbmcsCiAgICAgICAgU3RyaW5nID4gcmVzcG9uc2UgLT4KICAgICAgICBpZiAocmVzcG9uc2UuQkFOTyA9PSBudWxsKSB7CiAgICAgICAgICBtaS5lcnJvcigiSXRlbSBkb2Vzbid0IGV4aXN0IGluIHRoZSBMb3Q6ICAiICsgaUJBTk8pCiAgICAgICAgICB2YWxpZElucHV0ID0gZmFsc2UKICAgICAgICAgIHJldHVybiBmYWxzZQogICAgICAgIH0KICAgICAgfQogICAgICBtaUNhbGxlci5jYWxsKCJNTVMyMzVNSSIsICJHZXRJdG1Mb3QiLCBwYXJhbXMsIGNhbGxiYWNrKQogICAgfQoKICAgIGlmICgobWkuaW5EYXRhLmdldCgiSVZOTyIpICE9IG51bGwgJiYgIW1pLmluRGF0YS5nZXQoIklWTk8iKS50cmltKCkuaXNFbXB0eSgpKSkgewogICAgICAvL1ZhbGlkYXRlIEludm9pY2UgTnVtYmVyCiAgICAgIERCQWN0aW9uIGFjdGlvbiA9IGRhdGFiYXNlLnRhYmxlKCJPSU5WT0giKS5pbmRleCgiOTYiKS5idWlsZCgpCiAgICAgIERCQ29udGFpbmVyIHF1ZXJ5ID0gYWN0aW9uLmdldENvbnRhaW5lcigpCiAgICAgIHF1ZXJ5LnNldCgiVUhDT05PIiwgaUNPTk8pCiAgICAgIHF1ZXJ5LnNldCgiVUhESVZJIiwgaURJVkkpCiAgICAgIHF1ZXJ5LnNldCgiVUhFWElOIiwgaUlWTk8udG9TdHJpbmcoKSkKICAgICAgQ2xvc3VyZSA8ID8gPiByZXN1bHRzZXQgPSB7fQogICAgICBpZiAoYWN0aW9uLnJlYWRBbGwocXVlcnksIDMsIDEsIHJlc3VsdHNldCk+MCkgewogICAgICAgIG1pLmVycm9yKCJJbnZvaWNlIE51bWJlciBkb2VzIG5vdCBleGlzdC4iKQogICAgICAgIHZhbGlkSW5wdXQgPSBmYWxzZQogICAgICAgIHJldHVybiBmYWxzZQogICAgICB9CiAgICB9CgogICAgaWYgKCFpUFlDVS50cmltKCkuaXNFbXB0eSgpKSB7CiAgICAgIC8vVmFsaWRhdGUgQ3VzdG9tZXIgTnVtYmVyCiAgICAgIHBhcmFtcyA9IFsiQ1VOTyI6IGlQWUNVLnRvU3RyaW5nKCkudHJpbSgpXQogICAgICBjYWxsYmFjayA9IHsKICAgICAgICBNYXAgPCBTdHJpbmcsCiAgICAgICAgU3RyaW5nID4gcmVzcG9uc2UgLT4KICAgICAgICBpZiAocmVzcG9uc2UuQ1VOTyA9PSBudWxsKSB7CiAgICAgICAgICBtaS5lcnJvcigiSW52YWxpZCBDdXN0b21lciBOdW1iZXIgIiArIGlQWUNVKQogICAgICAgICAgdmFsaWRJbnB1dCA9IGZhbHNlCiAgICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgICB9CiAgICAgIH0KICAgICAgbWlDYWxsZXIuY2FsbCgiQ1JTNjEwTUkiLCAiR2V0QmFzaWNEYXRhIiwgcGFyYW1zLCBjYWxsYmFjaykKICAgIH0KCiAgfQogIC8qKgogICAqSW5zZXJ0IHJlY29yZHMgdG8gRVhUU01GIHRhYmxlCiAgICogQHBhcmFtcyAKICAgKiBAcmV0dXJuIAogICAqLwogIHB1YmxpYyBpbnNlcnRSZWNvcmQoKSB7CiAgICBEQkFjdGlvbiBhY3Rpb24gPSBkYXRhYmFzZS50YWJsZSgiRVhUU01GIikuaW5kZXgoIjAwIikuYnVpbGQoKQogICAgREJDb250YWluZXIgcXVlcnkgPSBhY3Rpb24uZ2V0Q29udGFpbmVyKCkKCiAgICBxdWVyeS5zZXQoIkVYRElWSSIsIGlESVZJKQogICAgcXVlcnkuc2V0KCJFWFJJRE4iLCBpUklETikKICAgIHF1ZXJ5LnNldCgiRVhGQUNJIiwgaUZBQ0kpCiAgICBxdWVyeS5zZXQoIkVYV0hMTyIsIGlXSExPKQogICAgcXVlcnkuc2V0KCJFWFBZQ1UiLCBpUFlDVSkKICAgIHF1ZXJ5LnNldCgiRVhTUE9DIiwgaVNQT0MpCiAgICBxdWVyeS5zZXQoIkVYSVZOTyIsIGlJVk5PIGFzIEludGVnZXIpCiAgICBxdWVyeS5zZXQoIkVYSVROTyIsIGlJVE5PKQogICAgcXVlcnkuc2V0KCJFWFNQSUQiLCBpU1BJRCkKICAgIHF1ZXJ5LnNldCgiRVhDU0lEIiwgaUNTSUQpCiAgICBxdWVyeS5zZXQoIkVYR1RJTiIsIGlHVElOKQogICAgcXVlcnkuc2V0KCJFWEJYTk8iLCBpQlhOTyBhcyBJbnRlZ2VyKQogICAgcXVlcnkuc2V0KCJFWFFVQU4iLCBpUVVBTiBhcyBJbnRlZ2VyKQogICAgcXVlcnkuc2V0KCJFWEJBTk8iLCBpQkFOTykKICAgIHF1ZXJ5LnNldCgiRVhVREYxIiwgaVVERjEpCiAgICBxdWVyeS5zZXQoIkVYVURGMiIsIGlVREYyIGFzIEludGVnZXIpCiAgICBxdWVyeS5zZXQoIkVYVURGMyIsIGlVREYzIGFzIEludGVnZXIpCiAgICBxdWVyeS5zZXQoIkVYVURGNCIsIGlVREY0KQogICAgcXVlcnkuc2V0KCJFWENPTk8iLCBpQ09OTyBhcyBJbnRlZ2VyKQogICAgcXVlcnkuc2V0KCJFWFJJREwiLCBpUklETCBhcyBJbnRlZ2VyKQogICAgcXVlcnkuc2V0KCJFWERMSVgiLCBpRExJWCBhcyBMb25nKQogICAgcXVlcnkuc2V0KCJFWFJHRFQiLCBMb2NhbERhdGVUaW1lLm5vdygpLmZvcm1hdChEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oInl5eXlNTWRkIikpLnRvSW50ZWdlcigpKQogICAgcXVlcnkuc2V0KCJFWFJHVE0iLCBMb2NhbERhdGVUaW1lLm5vdygpLmZvcm1hdChEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oIkhIbW1zcyIpKS50b0ludGVnZXIoKSkKICAgIHF1ZXJ5LnNldCgiRVhMTURUIiwgTG9jYWxEYXRlVGltZS5ub3coKS5mb3JtYXQoRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKCJ5eXl5TU1kZCIpKS50b0ludGVnZXIoKSkKICAgIHF1ZXJ5LnNldCgiRVhMTVRNIiwgTG9jYWxEYXRlVGltZS5ub3coKS5mb3JtYXQoRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKCJISG1tc3MiKSkudG9JbnRlZ2VyKCkpCiAgICBxdWVyeS5zZXQoIkVYQ0hOTyIsIDApCiAgICBxdWVyeS5zZXQoIkVYQ0hJRCIsIHByb2dyYW0uZ2V0VXNlcigpKQogICAgYWN0aW9uLmluc2VydChxdWVyeSwgcmVjb3JkRXhpc3RzKQogIH0KCiAgQ2xvc3VyZSByZWNvcmRFeGlzdHMgPSB7CiAgICBtaS5lcnJvcigiUmVjb3JkIEFscmVhZHkgRXhpc3RzIikKICAgIHJldHVybgogIH0KfQ=="}}}