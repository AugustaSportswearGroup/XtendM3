{"programModules":{"EXT510MI":{"program":"EXT510MI","triggers":{},"transactions":{"UpdLabelHead":{"sourceUuid":"ce878218-6bc3-44fd-86b4-750b22b64a6f","name":"UpdLabelHead","program":"EXT510MI","description":"Update Label Header Information","active":true,"multi":false,"modified":1700803035690,"modifiedBy":"M3CONSADMX","outputFields":[],"inputFields":[{"name":"CONO","description":"Company Number","length":3,"mandatory":false,"type":"N"},{"name":"DIVI","description":"Division","length":3,"mandatory":false,"type":"A"},{"name":"FACI","description":"Facility","length":3,"mandatory":false,"type":"A"},{"name":"WHLO","description":"Warehouse","length":3,"mandatory":true,"type":"A"},{"name":"PYCU","description":"Customer Number","length":10,"mandatory":false,"type":"A"},{"name":"SPOC","description":"Payer or Customer","length":1,"mandatory":false,"type":"A"},{"name":"DLIX","description":"Delivery Number","length":11,"mandatory":true,"type":"N"},{"name":"IVNO","description":"Invoice Number","length":9,"mandatory":false,"type":"N"},{"name":"RIDN","description":"Order Number","length":10,"mandatory":true,"type":"A"},{"name":"RIDL","description":"Order Line Number","length":6,"mandatory":true,"type":"N"},{"name":"ITNO","description":"Item Number","length":15,"mandatory":false,"type":"A"},{"name":"SPID","description":"ASN Shipment ID","length":18,"mandatory":false,"type":"A"},{"name":"CSID","description":"Case ID","length":18,"mandatory":false,"type":"A"},{"name":"GTIN","description":"GTIN","length":14,"mandatory":false,"type":"A"},{"name":"BXNO","description":"Box Number","length":4,"mandatory":false,"type":"N"},{"name":"QUAN","description":"Quantity","length":7,"mandatory":false,"type":"N"},{"name":"BANO","description":"Lot Number","length":12,"mandatory":false,"type":"A"},{"name":"UDF1","description":"User Defined Field 1","length":30,"mandatory":false,"type":"A"},{"name":"UDF2","description":"User Defined Field 2","length":10,"mandatory":false,"type":"N"},{"name":"UDF3","description":"User Defined Field 3","length":15,"mandatory":false,"type":"N"},{"name":"UDF4","description":"User Defined Field 4","length":1,"mandatory":false,"type":"A"}],"utilities":[]}},"batches":{},"advancedPrograms":{}}},"utilities":{},"sources":{"ce878218-6bc3-44fd-86b4-750b22b64a6f":{"uuid":"ce878218-6bc3-44fd-86b4-750b22b64a6f","updated":1701260918225,"updatedBy":"M3CONSADMX","created":1692270594951,"createdBy":"M3CONSADMX","apiVersion":"0.21","beVersion":"16.0.0.20230918173517.7","language":"GROOVY","codeHash":"9009EE31F576E4D0E49A28E7E22DA6DD0A22B8C7A2A1FAB15528A1A0EAF480CD","code":"LyoqCiAqIFJFQURNRQogKiBUaGlzIGV4dGVuc2lvbiBpcyBiZWluZyB1c2VkIHRvIFVwZGF0ZSByZWNvcmRzIHRvIEVYVFNNRiB0YWJsZS4gCiAqCiAqIE5hbWU6IEVYVDUxME1JLlVwZExhYmVsSGVhZAogKiBEZXNjcmlwdGlvbjogVXBkYXRpbmcgcmVjb3JkcyB0byBFWFRTTUYgdGFibGUKICogRGF0ZQkgICAgICBDaGFuZ2VkIEJ5ICAgICAgICAgICAgICAgICAgICAgIERlc2NyaXB0aW9uCiAqMjAyMzA4MTcgIFN1cml5YU5AZm9ydHVkZS5jbyAgICBVcGRhdGluZyByZWNvcmRzIHRvIEVYVFNNRiB0YWJsZQogKgogKi8KCmltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlVGltZQppbXBvcnQgamF2YS50aW1lLmZvcm1hdC5EYXRlVGltZUZvcm1hdHRlcgoKcHVibGljIGNsYXNzIFVwZExhYmVsSGVhZCBleHRlbmRzIEV4dGVuZE0zVHJhbnNhY3Rpb24gewogIHByaXZhdGUgZmluYWwgTUlBUEkgbWkKICBwcml2YXRlIGZpbmFsIERhdGFiYXNlQVBJIGRhdGFiYXNlCiAgcHJpdmF0ZSBmaW5hbCBQcm9ncmFtQVBJIHByb2dyYW0KICBwcml2YXRlIGZpbmFsIE1JQ2FsbGVyQVBJIG1pQ2FsbGVyCgogIHByaXZhdGUgU3RyaW5nIGlESVZJLCBpUklETiwgaUZBQ0ksIGlXSExPLCBpUFlDVSwgaVNQT0MsIGlJVE5PLCBpU1BJRCwgaUNTSUQsIGlHVElOLCBpQkFOTywgaVVERjEsIGlVREY0CiAgcHJpdmF0ZSBpbnQgaUNPTk8sIGlSSURMLCBpSVZOTywgaUJYTk8sIGlRVUFOLCBpVURGMiwgaVVERjMKICBwcml2YXRlIGxvbmcgaURMSVgKICBib29sZWFuIHZhbGlkSW5wdXQgPSB0cnVlCgogIHB1YmxpYyBVcGRMYWJlbEhlYWQoTUlBUEkgbWksIERhdGFiYXNlQVBJIGRhdGFiYXNlLCBQcm9ncmFtQVBJIHByb2dyYW0sIE1JQ2FsbGVyQVBJIG1pQ2FsbGVyKSB7CiAgICB0aGlzLm1pID0gbWkKICAgIHRoaXMuZGF0YWJhc2UgPSBkYXRhYmFzZQogICAgdGhpcy5wcm9ncmFtID0gcHJvZ3JhbQogICAgdGhpcy5taUNhbGxlciA9IG1pQ2FsbGVyCiAgfQogIC8qKgogICAqKiBNYWluIGZ1bmN0aW9uCiAgICogQHBhcmFtCiAgICogQHJldHVybgogICAqLwogIHB1YmxpYyB2b2lkIG1haW4oKSB7CiAgICBpRElWSSA9IChtaS5pbkRhdGEuZ2V0KCJESVZJIikgPT0gbnVsbCB8fCBtaS5pbkRhdGEuZ2V0KCJESVZJIikudHJpbSgpLmlzRW1wdHkoKSkgPyBwcm9ncmFtLkxEQVpELkRJVkkgOiBtaS5pbkRhdGEuZ2V0KCJESVZJIikKICAgIGlXSExPID0gKG1pLmluRGF0YS5nZXQoIldITE8iKSA9PSBudWxsIHx8IG1pLmluRGF0YS5nZXQoIldITE8iKS50cmltKCkuaXNFbXB0eSgpKSA/ICIiIDogbWkuaW5EYXRhLmdldCgiV0hMTyIpCiAgICBpUklETiA9IChtaS5pbkRhdGEuZ2V0KCJSSUROIikgPT0gbnVsbCB8fCBtaS5pbkRhdGEuZ2V0KCJSSUROIikudHJpbSgpLmlzRW1wdHkoKSkgPyAiIiA6IG1pLmluRGF0YS5nZXQoIlJJRE4iKQogICAgaUZBQ0kgPSAobWkuaW5EYXRhLmdldCgiRkFDSSIpID09IG51bGwgfHwgbWkuaW5EYXRhLmdldCgiRkFDSSIpLnRyaW0oKS5pc0VtcHR5KCkpID8gIiIgOiBtaS5pbkRhdGEuZ2V0KCJGQUNJIikKICAgIGlQWUNVID0gKG1pLmluRGF0YS5nZXQoIlBZQ1UiKSA9PSBudWxsIHx8IG1pLmluRGF0YS5nZXQoIlBZQ1UiKS50cmltKCkuaXNFbXB0eSgpKSA/ICIiIDogbWkuaW5EYXRhLmdldCgiUFlDVSIpCiAgICBpU1BPQyA9IChtaS5pbkRhdGEuZ2V0KCJTUE9DIikgPT0gbnVsbCB8fCBtaS5pbkRhdGEuZ2V0KCJTUE9DIikudHJpbSgpLmlzRW1wdHkoKSkgPyAiMCIgOiBtaS5pbkRhdGEuZ2V0KCJTUE9DIikKICAgIGlJVE5PID0gKG1pLmluRGF0YS5nZXQoIklUTk8iKSA9PSBudWxsIHx8IG1pLmluRGF0YS5nZXQoIklUTk8iKS50cmltKCkuaXNFbXB0eSgpKSA/ICIiIDogbWkuaW5EYXRhLmdldCgiSVROTyIpCiAgICBpU1BJRCA9IChtaS5pbkRhdGEuZ2V0KCJTUElEIikgPT0gbnVsbCB8fCBtaS5pbkRhdGEuZ2V0KCJTUElEIikudHJpbSgpLmlzRW1wdHkoKSkgPyAiIiA6IG1pLmluRGF0YS5nZXQoIlNQSUQiKQogICAgaUNTSUQgPSAobWkuaW5EYXRhLmdldCgiQ1NJRCIpID09IG51bGwgfHwgbWkuaW5EYXRhLmdldCgiQ1NJRCIpLnRyaW0oKS5pc0VtcHR5KCkpID8gIiIgOiBtaS5pbkRhdGEuZ2V0KCJDU0lEIikKICAgIGlHVElOID0gKG1pLmluRGF0YS5nZXQoIkdUSU4iKSA9PSBudWxsIHx8IG1pLmluRGF0YS5nZXQoIkdUSU4iKS50cmltKCkuaXNFbXB0eSgpKSA/ICIiIDogbWkuaW5EYXRhLmdldCgiR1RJTiIpCiAgICBpQkFOTyA9IChtaS5pbkRhdGEuZ2V0KCJCQU5PIikgPT0gbnVsbCB8fCBtaS5pbkRhdGEuZ2V0KCJCQU5PIikudHJpbSgpLmlzRW1wdHkoKSkgPyAiIiA6IG1pLmluRGF0YS5nZXQoIkJBTk8iKQogICAgaVVERjEgPSAobWkuaW5EYXRhLmdldCgiVURGMSIpID09IG51bGwgfHwgbWkuaW5EYXRhLmdldCgiVURGMSIpLnRyaW0oKS5pc0VtcHR5KCkpID8gIiIgOiBtaS5pbkRhdGEuZ2V0KCJVREYxIikKICAgIGlVREY0ID0gKG1pLmluRGF0YS5nZXQoIlVERjQiKSA9PSBudWxsIHx8IG1pLmluRGF0YS5nZXQoIlVERjQiKS50cmltKCkuaXNFbXB0eSgpKSA/ICIwIiA6IG1pLmluRGF0YS5nZXQoIlVERjQiKQoKICAgIGlDT05PID0gKG1pLmluRGF0YS5nZXQoIkNPTk8iKSA9PSBudWxsIHx8IG1pLmluRGF0YS5nZXQoIkNPTk8iKS50cmltKCkuaXNFbXB0eSgpKSA/IHByb2dyYW0uTERBWkQuQ09OTyBhcyBJbnRlZ2VyIDogbWkuaW5EYXRhLmdldCgiQ09OTyIpIGFzIEludGVnZXIKICAgIGlSSURMID0gKG1pLmluRGF0YS5nZXQoIlJJREwiKSA9PSBudWxsIHx8IG1pLmluRGF0YS5nZXQoIlJJREwiKS50cmltKCkuaXNFbXB0eSgpKSA/IDAgOiBtaS5pbkRhdGEuZ2V0KCJSSURMIikgYXMgSW50ZWdlcgogICAgaURMSVggPSAobWkuaW5EYXRhLmdldCgiRExJWCIpID09IG51bGwgfHwgbWkuaW5EYXRhLmdldCgiRExJWCIpLnRyaW0oKS5pc0VtcHR5KCkpID8gMCA6IG1pLmluRGF0YS5nZXQoIkRMSVgiKSBhcyBMb25nCiAgICBpSVZOTyA9IChtaS5pbkRhdGEuZ2V0KCJJVk5PIikgPT0gbnVsbCB8fCBtaS5pbkRhdGEuZ2V0KCJJVk5PIikudHJpbSgpLmlzRW1wdHkoKSkgPyAwIDogbWkuaW5EYXRhLmdldCgiSVZOTyIpIGFzIEludGVnZXIKICAgIGlVREYyID0gKG1pLmluRGF0YS5nZXQoIlVERjIiKSA9PSBudWxsIHx8IG1pLmluRGF0YS5nZXQoIlVERjIiKS50cmltKCkuaXNFbXB0eSgpKSA/IDAgOiBtaS5pbkRhdGEuZ2V0KCJVREYyIikgYXMgSW50ZWdlcgogICAgaVVERjMgPSAobWkuaW5EYXRhLmdldCgiVURGMyIpID09IG51bGwgfHwgbWkuaW5EYXRhLmdldCgiVURGMyIpLnRyaW0oKS5pc0VtcHR5KCkpID8gMCA6IG1pLmluRGF0YS5nZXQoIlVERjMiKSBhcyBJbnRlZ2VyCiAgICBpQlhOTyA9IChtaS5pbkRhdGEuZ2V0KCJCWE5PIikgPT0gbnVsbCB8fCBtaS5pbkRhdGEuZ2V0KCJCWE5PIikudHJpbSgpLmlzRW1wdHkoKSkgPyAwIDogbWkuaW5EYXRhLmdldCgiQlhOTyIpIGFzIEludGVnZXIKICAgIGlRVUFOID0gKG1pLmluRGF0YS5nZXQoIlFVQU4iKSA9PSBudWxsIHx8IG1pLmluRGF0YS5nZXQoIlFVQU4iKS50cmltKCkuaXNFbXB0eSgpKSA/IDAgOiBtaS5pbkRhdGEuZ2V0KCJRVUFOIikgYXMgSW50ZWdlcgoKICAgIHZhbGlkYXRlSW5wdXQoKQogICAgaWYgKHZhbGlkSW5wdXQpIHsKICAgICAgdXBkYXRlUmVjb3JkKCkKICAgIH0KCiAgfQoKICAvKioKICAgKlZhbGlkYXRlIFJlY29yZHMKICAgKiBAcGFyYW1zCiAgICogQHJldHVybiAKICAgKi8KICBwdWJsaWMgdmFsaWRhdGVJbnB1dCgpIHsKCiAgICAvL1ZhbGlkYXRlIENvbXBhbnkgTnVtYmVyCiAgICBkZWYgcGFyYW1zID0gWyJDT05PIjogaUNPTk8udG9TdHJpbmcoKS50cmltKCldCiAgICBkZWYgY2FsbGJhY2sgPSB7CiAgICAgIE1hcCA8IFN0cmluZywKICAgICAgU3RyaW5nID4gcmVzcG9uc2UgLT4KICAgICAgaWYgKHJlc3BvbnNlLkNPTk8gPT0gbnVsbCkgewogICAgICAgIG1pLmVycm9yKCJJbnZhbGlkIENvbXBhbnkgTnVtYmVyICIgKyBpQ09OTykKICAgICAgICB2YWxpZElucHV0ID0gZmFsc2UKICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgfQogICAgfQogICAgbWlDYWxsZXIuY2FsbCgiTU5TMDk1TUkiLCAiR2V0IiwgcGFyYW1zLCBjYWxsYmFjaykKICAgIAogICAgLy9WYWxpZGF0ZSBEaXZpc2lvbiAKICAgIGlmKCFpRElWSS50cmltKCkuaXNFbXB0eSgpKQogICAgewogICAgICAgIC8vVmFsaWRhdGUgSW52b2ljZSBOdW1iZXIKICAgICAgREJBY3Rpb24gYWN0aW9uID0gZGF0YWJhc2UudGFibGUoIkNNTkRJViIpLmluZGV4KCIwMCIpLmJ1aWxkKCkKICAgICAgREJDb250YWluZXIgcXVlcnkgPSBhY3Rpb24uZ2V0Q29udGFpbmVyKCkKICAgICAgcXVlcnkuc2V0KCJDQ0NPTk8iLCBpQ09OTykKICAgICAgcXVlcnkuc2V0KCJDQ0RJVkkiLCBpRElWSSkKICAgICAgaWYgKCFhY3Rpb24ucmVhZChxdWVyeSkpIHsKICAgICAgICBtaS5lcnJvcigiRGl2aXNpb24gZG9lcyBub3QgZXhpc3QuIikKICAgICAgICB2YWxpZElucHV0ID0gZmFsc2UKICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgfQogICAgfQogICAgCiAgICAKICAgIGlmICghaUlUTk8udHJpbSgpLmlzRW1wdHkoKSkgewogICAgICAvL1ZhbGlkYXRlIEl0ZW0gTnVtYmVyCiAgICAgIHBhcmFtcyA9IFsiQ09OTyI6IGlDT05PLnRvU3RyaW5nKCkudHJpbSgpLCAiSVROTyI6IGlJVE5PLnRvU3RyaW5nKCkudHJpbSgpXQogICAgICBjYWxsYmFjayA9IHsKICAgICAgICBNYXAgPCBTdHJpbmcsCiAgICAgICAgU3RyaW5nID4gcmVzcG9uc2UgLT4KICAgICAgICBpZiAocmVzcG9uc2UuSVROTyA9PSBudWxsKSB7CiAgICAgICAgICBtaS5lcnJvcigiSW52YWxpZCBJdGVtIE51bWJlciAiICsgaUlUTk8pCiAgICAgICAgICB2YWxpZElucHV0ID0gZmFsc2UKICAgICAgICAgIHJldHVybiBmYWxzZQogICAgICAgIH0KICAgICAgfQogICAgICAKICAgIG1pQ2FsbGVyLmNhbGwoIk1NUzIwME1JIiwgIkdldCIsIHBhcmFtcywgY2FsbGJhY2spCiAgICB9CgogICAgaWYgKCFpRkFDSS50cmltKCkuaXNFbXB0eSgpKSB7CiAgICAgIC8vVmFsaWRhdGUgRmFjaWxpdHkgTnVtYmVyCiAgICAgIHBhcmFtcyA9IFsiQ09OTyI6IGlDT05PLnRvU3RyaW5nKCkudHJpbSgpLCAiRkFDSSI6IGlGQUNJLnRvU3RyaW5nKCkudHJpbSgpXQogICAgICBjYWxsYmFjayA9IHsKICAgICAgICBNYXAgPCBTdHJpbmcsCiAgICAgICAgU3RyaW5nID4gcmVzcG9uc2UgLT4KICAgICAgICBpZiAocmVzcG9uc2UuRkFDSSA9PSBudWxsKSB7CiAgICAgICAgICBtaS5lcnJvcigiSW52YWxpZCBGYWNpbGl0eSBOdW1iZXIgIiArIGlGQUNJKQogICAgICAgICAgdmFsaWRJbnB1dCA9IGZhbHNlCiAgICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgICB9CiAgICAgIH0KICAgICAgbWlDYWxsZXIuY2FsbCgiQ1JTMDA4TUkiLCAiR2V0IiwgcGFyYW1zLCBjYWxsYmFjaykKICAgIH0KCiAgICBpZiAoIWlSSUROLnRyaW0oKS5pc0VtcHR5KCkpIHsKICAgICAgLy9WYWxpZGF0ZSBPcmRlciBOdW1iZXIgT3JkZXIgTGluZSBjb21ibwogICAgICBwYXJhbXMgPSBbIkNPTk8iOiBpQ09OTy50b1N0cmluZygpLnRyaW0oKSwgIk9STk8iOiBpUklETi50b1N0cmluZygpLnRyaW0oKSwgIlBPTlIiOiBpUklETC50b1N0cmluZygpLnRyaW0oKV0KICAgICAgY2FsbGJhY2sgPSB7CiAgICAgICAgTWFwIDwgU3RyaW5nLAogICAgICAgIFN0cmluZyA+IHJlc3BvbnNlIC0+CiAgICAgICAgaWYgKHJlc3BvbnNlLklUTk8gPT0gbnVsbCkgewogICAgICAgICAgdmFsaWRJbnB1dCA9IGZhbHNlCiAgICAgICAgfQogICAgICB9CiAgICAgIG1pQ2FsbGVyLmNhbGwoIk9JUzEwME1JIiwgIkdldExpbmUiLCBwYXJhbXMsIGNhbGxiYWNrKQoKICAgICAgLy9JZiBub3QgQ08sIGNoZWNrIGlmIHZhbGlkIERPCiAgICAgIGlmICghdmFsaWRJbnB1dCkgewogICAgICAgIHZhbGlkSW5wdXQgPSB0cnVlCiAgICAgICAgcGFyYW1zID0gWyJDT05PIjogaUNPTk8udG9TdHJpbmcoKS50cmltKCksICJUUk5SIjogaVJJRE4udG9TdHJpbmcoKS50cmltKCksICJQT05SIjogaVJJREwudG9TdHJpbmcoKS50cmltKCldCiAgICAgICAgY2FsbGJhY2sgPSB7CiAgICAgICAgICBNYXAgPCBTdHJpbmcsCiAgICAgICAgICBTdHJpbmcgPiByZXNwb25zZSAtPgogICAgICAgICAgaWYgKHJlc3BvbnNlLklUTk8gPT0gbnVsbCkgewogICAgICAgICAgICBtaS5lcnJvcigiSW52YWxpZCBPcmRlciBOdW1iZXIgLSBPcmRlciBMaW5lICIgKyBpUklETikKICAgICAgICAgICAgdmFsaWRJbnB1dCA9IGZhbHNlCiAgICAgICAgICAgIHJldHVybiBmYWxzZQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBtaUNhbGxlci5jYWxsKCJNTVMxMDBNSSIsICJHZXRIZWFkIiwgcGFyYW1zLCBjYWxsYmFjaykKICAgICAgfQogICAgfQoKICAgIC8vVmFsaWRhdGUgRGVsaXZlcnkgTnVtYmVyCiAgICBwYXJhbXMgPSBbIkNPTk8iOiBpQ09OTy50b1N0cmluZygpLnRyaW0oKSwgIkRMSVgiOiBpRExJWC50b1N0cmluZygpLnRyaW0oKV0KICAgIGNhbGxiYWNrID0gewogICAgICBNYXAgPCBTdHJpbmcsCiAgICAgIFN0cmluZyA+IHJlc3BvbnNlIC0+CiAgICAgIGlmIChyZXNwb25zZS5ETElYID09IG51bGwpIHsKICAgICAgICBtaS5lcnJvcigiSW52YWxpZCBEZWxpdmVyeSBOdW1iZXIgIiArIGlETElYKQogICAgICAgIHZhbGlkSW5wdXQgPSBmYWxzZQogICAgICAgIHJldHVybiBmYWxzZQogICAgICB9CiAgICB9CiAgICBtaUNhbGxlci5jYWxsKCJNV1M0MTBNSSIsICJHZXRIZWFkIiwgcGFyYW1zLCBjYWxsYmFjaykKCiAgICBpZiAoIWlXSExPLnRyaW0oKS5pc0VtcHR5KCkpIHsKICAgICAgLy9WYWxpZGF0ZSBXYXJlaG91c2UgTnVtYmVyCiAgICAgIHBhcmFtcyA9IFsiQ09OTyI6IGlDT05PLnRvU3RyaW5nKCkudHJpbSgpLCAiV0hMTyI6IGlXSExPLnRvU3RyaW5nKCkudHJpbSgpXQogICAgICBjYWxsYmFjayA9IHsKICAgICAgICBNYXAgPCBTdHJpbmcsCiAgICAgICAgU3RyaW5nID4gcmVzcG9uc2UgLT4KICAgICAgICBpZiAocmVzcG9uc2UuV0hMTyA9PSBudWxsKSB7CiAgICAgICAgICBtaS5lcnJvcigiSW52YWxpZCBXYXJlaG91c2UgTnVtYmVyICIgKyBpV0hMTykKICAgICAgICAgIHZhbGlkSW5wdXQgPSBmYWxzZQogICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgfQogICAgICB9CiAgICAgIG1pQ2FsbGVyLmNhbGwoIk1NUzAwNU1JIiwgIkdldFdhcmVob3VzZSIsIHBhcmFtcywgY2FsbGJhY2spCiAgICB9CgogICAgaWYgKCFpQkFOTy50cmltKCkuaXNFbXB0eSgpKSB7CiAgICAgIC8vVmFsaWRhdGUgTG90IE51bWJlcgogICAgICBwYXJhbXMgPSBbIkNPTk8iOiBpQ09OTy50b1N0cmluZygpLnRyaW0oKSwgIkJBTk8iOiBpQkFOTy50b1N0cmluZygpLnRyaW0oKSwgIklUTk8iOiBpSVROTy50b1N0cmluZygpLnRyaW0oKV0KICAgICAgY2FsbGJhY2sgPSB7CiAgICAgICAgTWFwIDwgU3RyaW5nLAogICAgICAgIFN0cmluZyA+IHJlc3BvbnNlIC0+CiAgICAgICAgaWYgKHJlc3BvbnNlLkJBTk8gPT0gbnVsbCkgewogICAgICAgICAgbWkuZXJyb3IoIkl0ZW0gZG9lc24ndCBleGlzdCBpbiB0aGUgTG90OiAgIiArIGlCQU5PKQogICAgICAgICAgdmFsaWRJbnB1dCA9IGZhbHNlCiAgICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgICB9CiAgICAgIH0KICAgICAgbWlDYWxsZXIuY2FsbCgiTU1TMjM1TUkiLCAiR2V0SXRtTG90IiwgcGFyYW1zLCBjYWxsYmFjaykKICAgIH0KCiAgICBpZiAoKG1pLmluRGF0YS5nZXQoIklWTk8iKSAhPSBudWxsICYmICFtaS5pbkRhdGEuZ2V0KCJJVk5PIikudHJpbSgpLmlzRW1wdHkoKSkpIHsKICAgICAgLy9WYWxpZGF0ZSBJbnZvaWNlIE51bWJlcgogICAgICBEQkFjdGlvbiBhY3Rpb24gPSBkYXRhYmFzZS50YWJsZSgiT0lOVk9IIikuaW5kZXgoIjk2IikuYnVpbGQoKQogICAgICBEQkNvbnRhaW5lciBxdWVyeSA9IGFjdGlvbi5nZXRDb250YWluZXIoKQogICAgICBxdWVyeS5zZXQoIlVIQ09OTyIsIGlDT05PKQogICAgICBxdWVyeS5zZXQoIlVIRElWSSIsIGlESVZJKQogICAgICBxdWVyeS5zZXQoIlVIRVhJTiIsIGlJVk5PLnRvU3RyaW5nKCkpCiAgICAgIENsb3N1cmUgPCA/ID4gcmVzdWx0c2V0ID0ge30KICAgICAgaWYgKGFjdGlvbi5yZWFkQWxsKHF1ZXJ5LCAzLCAxLCByZXN1bHRzZXQpPjApIHsKICAgICAgICBtaS5lcnJvcigiSW52b2ljZSBOdW1iZXIgZG9lcyBub3QgZXhpc3QuIikKICAgICAgICB2YWxpZElucHV0ID0gZmFsc2UKICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgfQogICAgfQoKICAgIGlmICghaVBZQ1UudHJpbSgpLmlzRW1wdHkoKSkgewogICAgICAvL1ZhbGlkYXRlIEN1c3RvbWVyIE51bWJlcgogICAgICBwYXJhbXMgPSBbIkNVTk8iOiBpUFlDVS50b1N0cmluZygpLnRyaW0oKV0KICAgICAgY2FsbGJhY2sgPSB7CiAgICAgICAgTWFwIDwgU3RyaW5nLAogICAgICAgIFN0cmluZyA+IHJlc3BvbnNlIC0+CiAgICAgICAgaWYgKHJlc3BvbnNlLkNVTk8gPT0gbnVsbCkgewogICAgICAgICAgbWkuZXJyb3IoIkludmFsaWQgQ3VzdG9tZXIgTnVtYmVyICIgKyBpUFlDVSkKICAgICAgICAgIHZhbGlkSW5wdXQgPSBmYWxzZQogICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgfQogICAgICB9CiAgICAgIG1pQ2FsbGVyLmNhbGwoIkNSUzYxME1JIiwgIkdldEJhc2ljRGF0YSIsIHBhcmFtcywgY2FsbGJhY2spCiAgICB9CgogIH0KCiAgLyoqCiAgICpVcGRhdGUgcmVjb3JkcyB0byBFWFRTTUYgdGFibGUKICAgKiBAcGFyYW1zIAogICAqIEByZXR1cm4gCiAgICovCiAgcHVibGljIHVwZGF0ZVJlY29yZCgpIHsKICAgIERCQWN0aW9uIHF1ZXJ5ID0gZGF0YWJhc2UudGFibGUoIkVYVFNNRiIpLmluZGV4KCIwMCIpLmJ1aWxkKCkKICAgIERCQ29udGFpbmVyIGNvbnRhaW5lciA9IHF1ZXJ5LmdldENvbnRhaW5lcigpCgogICAgY29udGFpbmVyLnNldCgiRVhDT05PIiwgaUNPTk8pCiAgICBjb250YWluZXIuc2V0KCJFWERJVkkiLCBpRElWSSkKICAgIGNvbnRhaW5lci5zZXQoIkVYV0hMTyIsIGlXSExPKQogICAgY29udGFpbmVyLnNldCgiRVhSSUROIiwgaVJJRE4pCiAgICBjb250YWluZXIuc2V0KCJFWERMSVgiLCBpRExJWCBhcyBMb25nKQogICAgaWYgKCEgcXVlcnkucmVhZExvY2soY29udGFpbmVyLCB1cGRhdGVDYWxsQmFjaykpIHsKICAgICAgbWkuZXJyb3IoIlJlY29yZCBkb2VzIG5vdCBFeGlzdC4iKQogICAgICByZXR1cm4KICAgIH0KICB9CgogIENsb3N1cmUgPCA/ID4gdXBkYXRlQ2FsbEJhY2sgPSB7CiAgICBMb2NrZWRSZXN1bHQgbG9ja2VkUmVzdWx0IC0+CiAgICBpbnQgQ0hOTyA9IGxvY2tlZFJlc3VsdC5nZXQoIkVYQ0hOTyIpCiAgICBpZiAoIWlGQUNJLnRyaW0oKS5pc0VtcHR5KCkpIHsKICAgICAgaWYgKGlGQUNJLnRyaW0oKS5lcXVhbHMoIj8iKSkgewogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYRkFDSSIsICIiKQogICAgICB9IGVsc2UgewogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYRkFDSSIsIGlGQUNJKQogICAgICB9CiAgICB9CiAgICBpZiAoIWlQWUNVLnRyaW0oKS5pc0VtcHR5KCkpIHsKICAgICAgaWYgKGlQWUNVLnRyaW0oKS5lcXVhbHMoIj8iKSkgewogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYUFlDVSIsICIiKQogICAgICB9IGVsc2UgewogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYUFlDVSIsIGlQWUNVKQogICAgICB9CiAgICB9CiAgICBpZiAoIWlTUE9DLnRyaW0oKS5pc0VtcHR5KCkpIHsKICAgICAgaWYgKGlTUE9DLnRyaW0oKS5lcXVhbHMoIj8iKSkgewogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYU1BPQyIsICIiKQogICAgICB9IGVsc2UgewogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYU1BPQyIsIGlTUE9DKQogICAgICB9CiAgICB9CiAgICBpZiAoIWlJVE5PLnRyaW0oKS5pc0VtcHR5KCkpIHsKICAgICAgaWYgKGlJVE5PLnRyaW0oKS5lcXVhbHMoIj8iKSkgewogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYSVROTyIsICIiKQogICAgICB9IGVsc2UgewogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYSVROTyIsIGlJVE5PKQogICAgICB9CiAgICB9CiAgICBpZiAoIWlTUElELnRyaW0oKS5pc0VtcHR5KCkpIHsKICAgICAgaWYgKGlTUElELnRyaW0oKS5lcXVhbHMoIj8iKSkgewogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYU1BJRCIsICIiKQogICAgICB9IGVsc2UgewogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYU1BJRCIsIGlTUElEKQogICAgICB9CiAgICB9CiAgICBpZiAoIWlDU0lELnRyaW0oKS5pc0VtcHR5KCkpIHsKICAgICAgaWYgKGlDU0lELnRyaW0oKS5lcXVhbHMoIj8iKSkgewogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYQ1NJRCIsICIiKQogICAgICB9IGVsc2UgewogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYQ1NJRCIsIGlDU0lEKQogICAgICB9CiAgICB9CiAgICBpZiAoIWlHVElOLnRyaW0oKS5pc0VtcHR5KCkpIHsKICAgICAgaWYgKGlHVElOLnRyaW0oKS5lcXVhbHMoIj8iKSkgewogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYR1RJTiIsICIiKQogICAgICB9IGVsc2UgewogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYR1RJTiIsIGlHVElOKQogICAgICB9CiAgICB9CiAgICBpZiAoIWlCQU5PLnRyaW0oKS5pc0VtcHR5KCkpIHsKICAgICAgaWYgKGlCQU5PLnRyaW0oKS5lcXVhbHMoIj8iKSkgewogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYQkFOTyIsICIiKQogICAgICB9IGVsc2UgewogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYQkFOTyIsIGlCQU5PKQogICAgICB9CiAgICB9CiAgICBpZiAoIWlVREYxLnRyaW0oKS5pc0VtcHR5KCkpIHsKICAgICAgaWYgKGlVREYxLnRyaW0oKS5lcXVhbHMoIj8iKSkgewogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYVURGMSIsICIiKQogICAgICB9IGVsc2UgewogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYVURGMSIsIGlVREYxKQogICAgICB9CiAgICB9CiAgICBpZiAoIWlVREY0LnRyaW0oKS5pc0VtcHR5KCkpIHsKICAgICAgaWYgKGlVREY0LnRyaW0oKS5lcXVhbHMoIj8iKSkgewogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYVURGNCIsICIiKQogICAgICB9IGVsc2UgewogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYVURGNCIsIGlVREY0KQogICAgICB9CiAgICB9CiAgICAKICAgIGlmIChtaS5pbkRhdGEuZ2V0KCJCWE5PIikgIT0gbnVsbCAmJiAhbWkuaW5EYXRhLmdldCgiVURGMiIpLnRyaW0oKS5pc0VtcHR5KCkpIHsKICAgICAgbG9ja2VkUmVzdWx0LnNldCgiRVhCWE5PIiwgaUJYTk8pCiAgICB9CiAgICBpZiAobWkuaW5EYXRhLmdldCgiUVVBTiIpICE9IG51bGwgJiYgIW1pLmluRGF0YS5nZXQoIlFVQU4iKS50cmltKCkuaXNFbXB0eSgpKSB7CiAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYUVVBTiIsIGlRVUFOKQogICAgfQogICAgaWYgKG1pLmluRGF0YS5nZXQoIklWTk8iKSAhPSBudWxsICYmICFtaS5pbkRhdGEuZ2V0KCJVREYyIikudHJpbSgpLmlzRW1wdHkoKSkgewogICAgICBsb2NrZWRSZXN1bHQuc2V0KCJFWElWTk8iLCBpSVZOTykKICAgIH0KICAgIGlmIChtaS5pbkRhdGEuZ2V0KCJVREYyIikgIT0gbnVsbCAmJiAhbWkuaW5EYXRhLmdldCgiVURGMiIpLnRyaW0oKS5pc0VtcHR5KCkpIHsKICAgICAgbG9ja2VkUmVzdWx0LnNldCgiRVhVREYyIiwgaVVERjIpCiAgICB9CiAgICBpZiAobWkuaW5EYXRhLmdldCgiVURGMyIpICE9IG51bGwgJiYgIW1pLmluRGF0YS5nZXQoIlVERjMiKS50cmltKCkuaXNFbXB0eSgpKSB7CiAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYVURGMyIsIGlVREYzKQogICAgfQogICAgaWYgKG1pLmluRGF0YS5nZXQoIlJJREwiKSAhPSBudWxsICYmICFtaS5pbkRhdGEuZ2V0KCJSSURMIikudHJpbSgpLmlzRW1wdHkoKSkgewogICAgICBsb2NrZWRSZXN1bHQuc2V0KCJFWFJJREwiLCBpUklETCkKICAgIH0KICAgIGlmIChtaS5pbkRhdGEuZ2V0KCJSSURMIikgIT0gbnVsbCAmJiAhbWkuaW5EYXRhLmdldCgiUklETCIpLnRyaW0oKS5pc0VtcHR5KCkpIHsKICAgICAgbG9ja2VkUmVzdWx0LnNldCgiRVhSSURMIiwgaVJJREwpCiAgICB9CiAgICBpZiAobWkuaW5EYXRhLmdldCgiUklETCIpICE9IG51bGwgJiYgIW1pLmluRGF0YS5nZXQoIlJJREwiKS50cmltKCkuaXNFbXB0eSgpKSB7CiAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYUklETCIsIGlSSURMKQogICAgfQoKICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYTE1EVCIsIExvY2FsRGF0ZVRpbWUubm93KCkuZm9ybWF0KERhdGVUaW1lRm9ybWF0dGVyLm9mUGF0dGVybigieXl5eU1NZGQiKSkudG9JbnRlZ2VyKCkpCiAgICBsb2NrZWRSZXN1bHQuc2V0KCJFWExNVE0iLCBMb2NhbERhdGVUaW1lLm5vdygpLmZvcm1hdChEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oIkhIbW1zcyIpKS50b0ludGVnZXIoKSkKICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYQ0hOTyIsIENITk8rMSkKICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYQ0hJRCIsIHByb2dyYW0uZ2V0VXNlcigpKQogICAgbG9ja2VkUmVzdWx0LnVwZGF0ZSgpCiAgfQp9"}}}