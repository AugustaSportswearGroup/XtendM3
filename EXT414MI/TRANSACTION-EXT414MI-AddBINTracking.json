{"programModules":{"EXT414MI":{"program":"EXT414MI","triggers":{},"transactions":{"AddBINTracking":{"sourceUuid":"c7ee058e-0fd8-4004-ad63-ab120be98aec","name":"AddBINTracking","program":"EXT414MI","description":"Add BIN Tracking File","active":true,"multi":false,"modified":1695636713971,"modifiedBy":"M3CONSADMX","outputFields":[],"inputFields":[{"name":"CONO","description":"Company Number","length":3,"mandatory":false,"type":"N"},{"name":"DIVI","description":"Division","length":3,"mandatory":false,"type":"A"},{"name":"FACI","description":"Facility","length":3,"mandatory":false,"type":"A"},{"name":"WHLO","description":"Warehouse","length":3,"mandatory":true,"type":"A"},{"name":"RCID","description":"Route Carton ID","length":15,"mandatory":true,"type":"A"},{"name":"CISN","description":"Carton ID Ref#","length":6,"mandatory":false,"type":"N"},{"name":"LICP","description":"License Plate","length":15,"mandatory":true,"type":"A"},{"name":"TTYP","description":"Stock Transaction Type","length":2,"mandatory":true,"type":"N"},{"name":"ORNO","description":"Order Number","length":10,"mandatory":true,"type":"A"},{"name":"DLIX","description":"Delivery Number","length":11,"mandatory":true,"type":"N"},{"name":"BXNO","description":"Box Number","length":4,"mandatory":false,"type":"N"},{"name":"STAT","description":"Status","length":2,"mandatory":false,"type":"A"},{"name":"LMFS","description":"Last Msg Sort","length":4,"mandatory":false,"type":"A"},{"name":"LMFD","description":"Last Msg Divert","length":4,"mandatory":false,"type":"A"},{"name":"CUNO","description":"Bill to Customer","length":10,"mandatory":false,"type":"A"},{"name":"MODL","description":"Delivery Method","length":3,"mandatory":false,"type":"A"},{"name":"TEPY","description":"Payment Terms","length":3,"mandatory":false,"type":"A"},{"name":"TEPA","description":"Packaging Terms","length":3,"mandatory":false,"type":"A"},{"name":"ESTW","description":"Est. Wght","length":1,"mandatory":false,"type":"N"},{"name":"ACTW","description":"Act. Wght","length":12,"mandatory":false,"type":"N"},{"name":"WGTO","description":"Weight Tolerance","length":3,"mandatory":false,"type":"N"},{"name":"WGFG","description":"Weight Flag","length":1,"mandatory":false,"type":"A"},{"name":"QAFG","description":"QA Flag","length":1,"mandatory":false,"type":"A"},{"name":"SMFG","description":"Sample Flag","length":1,"mandatory":false,"type":"A"},{"name":"ONFM","description":"Confirmed","length":1,"mandatory":false,"type":"A"},{"name":"PKDV","description":"Pick Divert","length":150,"mandatory":false,"type":"A"},{"name":"PSDV","description":"Prescale Divert","length":50,"mandatory":false,"type":"A"},{"name":"PTDV","description":"Postscale Divert","length":50,"mandatory":false,"type":"A"},{"name":"LNDV","description":"Ship Lane Divert","length":4,"mandatory":false,"type":"A"},{"name":"FD01","description":"Future Divert 1","length":20,"mandatory":false,"type":"A"},{"name":"FD02","description":"Future Divert 2","length":20,"mandatory":false,"type":"A"},{"name":"UD01","description":"User Defined 1","length":50,"mandatory":false,"type":"A"},{"name":"UD02","description":"User Defined 2","length":50,"mandatory":false,"type":"A"},{"name":"UD03","description":"User Defined 3","length":21,"mandatory":false,"type":"N"}],"utilities":[]}},"batches":{},"advancedPrograms":{}}},"utilities":{},"sources":{"c7ee058e-0fd8-4004-ad63-ab120be98aec":{"uuid":"c7ee058e-0fd8-4004-ad63-ab120be98aec","updated":1700741214091,"updatedBy":"M3CONSADMX","created":1695296809632,"createdBy":"M3CONSADMX","apiVersion":"0.9","beVersion":"16.0.0.20230918173517.7","language":"GROOVY","codeHash":"917538403AF386C16759633CC4B89089DBD6A6888C4E26FA70A10543F06D2B37","code":"LyoqCiAqIFJFQURNRQogKiBUaGlzIGV4dGVuc2lvbiBpcyBiZWluZyB1c2VkIHRvIEFkZCByZWNvcmRzIHRvIEVYVE5CTiB0YWJsZS4gCiAqCiAqIE5hbWU6IEVYVDQxNE1JLkFkZEJJTlRyYWNraW5nCiAqIERlc2NyaXB0aW9uOiBBZGRpbmcgcmVjb3JkcyB0byBFWFROQk4gdGFibGUgCiAqIERhdGUJICAgICAgQ2hhbmdlZCBCeSAgICAgICAgICAgICAgICAgICAgICBEZXNjcmlwdGlvbgogKjIwMjMwOTIxICBTdXJpeWFOQGZvcnR1ZGUuY28gICAgIEFkZGluZyByZWNvcmRzIHRvIEVYVE5CTiB0YWJsZSAqLwoKaW1wb3J0IGphdmEudGltZS5Mb2NhbERhdGVUaW1lCmltcG9ydCBqYXZhLnRpbWUuZm9ybWF0LkRhdGVUaW1lRm9ybWF0dGVyCgpwdWJsaWMgY2xhc3MgQWRkQklOVHJhY2tpbmcgZXh0ZW5kcyBFeHRlbmRNM1RyYW5zYWN0aW9uIHsKICBwcml2YXRlIGZpbmFsIE1JQVBJIG1pCiAgcHJpdmF0ZSBmaW5hbCBEYXRhYmFzZUFQSSBkYXRhYmFzZQogIHByaXZhdGUgZmluYWwgUHJvZ3JhbUFQSSBwcm9ncmFtCiAgcHJpdmF0ZSBmaW5hbCBNSUNhbGxlckFQSSBtaUNhbGxlcgoKICBwcml2YXRlIFN0cmluZyBpRElWSSwgaVdITE8sIGlGQUNJLCBpUkNJRCwgaUxJQ1AsIGlPUk5PLCBpU1RBVCwgaUNVTk8sIGlNT0RMLCBpVEVQWSwgaVRFUEEsIGlXR0ZHLCBpUUFGRywgaVNNRkcsIGlPTkZNLCBpTE1GUywgaUxNRkQsIGlQS0RWLCBpUFNEViwgaVBURFYsIGlMTkRWLCBpRkQwMSwgaUZEMDIsIGlVRDAxLCBpVUQwMgogIHByaXZhdGUgaW50IGlDT05PLCBpQ0lTTiwgaVRUWVAsIGlCWE5PLCBpV0dUTwogIHByaXZhdGUgbG9uZyBpRExJWAogIHByaXZhdGUgRG91YmxlIGlBQ1RXLCBpRVNUVywgaVVEMDMKICBwcml2YXRlIGJvb2xlYW4gdmFsaWRJbnB1dCA9IHRydWUKCiAgcHVibGljIEFkZEJJTlRyYWNraW5nKE1JQVBJIG1pLCBEYXRhYmFzZUFQSSBkYXRhYmFzZSwgUHJvZ3JhbUFQSSBwcm9ncmFtLCBNSUNhbGxlckFQSSBtaUNhbGxlcikgewogICAgdGhpcy5taSA9IG1pCiAgICB0aGlzLmRhdGFiYXNlID0gZGF0YWJhc2UKICAgIHRoaXMucHJvZ3JhbSA9IHByb2dyYW0KICAgIHRoaXMubWlDYWxsZXIgPSBtaUNhbGxlcgogIH0KICAvKioKICAgKiogTWFpbiBmdW5jdGlvbgogICAqIEBwYXJhbQogICAqIEByZXR1cm4KICAgKi8KICBwdWJsaWMgdm9pZCBtYWluKCkgewogICAgaURJVkkgPSAobWkuaW5EYXRhLmdldCgiRElWSSIpID09IG51bGwgfHwgbWkuaW5EYXRhLmdldCgiRElWSSIpLnRyaW0oKS5pc0VtcHR5KCkpID8gcHJvZ3JhbS5MREFaRC5ESVZJIDogbWkuaW5EYXRhLmdldCgiRElWSSIpCiAgICBpV0hMTyA9IChtaS5pbkRhdGEuZ2V0KCJXSExPIikgPT0gbnVsbCB8fCBtaS5pbkRhdGEuZ2V0KCJXSExPIikudHJpbSgpLmlzRW1wdHkoKSkgPyAiIiA6IG1pLmluRGF0YS5nZXQoIldITE8iKQogICAgaUZBQ0kgPSAobWkuaW5EYXRhLmdldCgiRkFDSSIpID09IG51bGwgfHwgbWkuaW5EYXRhLmdldCgiRkFDSSIpLnRyaW0oKS5pc0VtcHR5KCkpID8gIiIgOiBtaS5pbkRhdGEuZ2V0KCJGQUNJIikKICAgIGlSQ0lEID0gKG1pLmluRGF0YS5nZXQoIlJDSUQiKSA9PSBudWxsIHx8IG1pLmluRGF0YS5nZXQoIlJDSUQiKS50cmltKCkuaXNFbXB0eSgpKSA/ICIiIDogbWkuaW5EYXRhLmdldCgiUkNJRCIpCiAgICBpTElDUCA9IChtaS5pbkRhdGEuZ2V0KCJMSUNQIikgPT0gbnVsbCB8fCBtaS5pbkRhdGEuZ2V0KCJMSUNQIikudHJpbSgpLmlzRW1wdHkoKSkgPyAiIiA6IG1pLmluRGF0YS5nZXQoIkxJQ1AiKQogICAgaU9STk8gPSAobWkuaW5EYXRhLmdldCgiT1JOTyIpID09IG51bGwgfHwgbWkuaW5EYXRhLmdldCgiT1JOTyIpLnRyaW0oKS5pc0VtcHR5KCkpID8gIiIgOiBtaS5pbkRhdGEuZ2V0KCJPUk5PIikKICAgIGlTVEFUID0gKG1pLmluRGF0YS5nZXQoIlNUQVQiKSA9PSBudWxsIHx8IG1pLmluRGF0YS5nZXQoIlNUQVQiKS50cmltKCkuaXNFbXB0eSgpKSA/ICIiIDogbWkuaW5EYXRhLmdldCgiU1RBVCIpCiAgICBpQ1VOTyA9IChtaS5pbkRhdGEuZ2V0KCJDVU5PIikgPT0gbnVsbCB8fCBtaS5pbkRhdGEuZ2V0KCJDVU5PIikudHJpbSgpLmlzRW1wdHkoKSkgPyAiIiA6IG1pLmluRGF0YS5nZXQoIkNVTk8iKQogICAgaU1PREwgPSAobWkuaW5EYXRhLmdldCgiTU9ETCIpID09IG51bGwgfHwgbWkuaW5EYXRhLmdldCgiTU9ETCIpLnRyaW0oKS5pc0VtcHR5KCkpID8gIiIgOiBtaS5pbkRhdGEuZ2V0KCJNT0RMIikKICAgIGlURVBZID0gKG1pLmluRGF0YS5nZXQoIlRFUFkiKSA9PSBudWxsIHx8IG1pLmluRGF0YS5nZXQoIlRFUFkiKS50cmltKCkuaXNFbXB0eSgpKSA/ICIiIDogbWkuaW5EYXRhLmdldCgiVEVQWSIpCiAgICBpVEVQQSA9IChtaS5pbkRhdGEuZ2V0KCJURVBBIikgPT0gbnVsbCB8fCBtaS5pbkRhdGEuZ2V0KCJURVBBIikudHJpbSgpLmlzRW1wdHkoKSkgPyAiIiA6IG1pLmluRGF0YS5nZXQoIlRFUEEiKQogICAgaVdHRkcgPSAobWkuaW5EYXRhLmdldCgiV0dGRyIpID09IG51bGwgfHwgbWkuaW5EYXRhLmdldCgiV0dGRyIpLnRyaW0oKS5pc0VtcHR5KCkpID8gIiAiIDogbWkuaW5EYXRhLmdldCgiV0dGRyIpCiAgICBpUUFGRyA9IChtaS5pbkRhdGEuZ2V0KCJRQUZHIikgPT0gbnVsbCB8fCBtaS5pbkRhdGEuZ2V0KCJRQUZHIikudHJpbSgpLmlzRW1wdHkoKSkgPyAiICIgOiBtaS5pbkRhdGEuZ2V0KCJRQUZHIikKICAgIGlTTUZHID0gKG1pLmluRGF0YS5nZXQoIlNNRkciKSA9PSBudWxsIHx8IG1pLmluRGF0YS5nZXQoIlNNRkciKS50cmltKCkuaXNFbXB0eSgpKSA/ICIgIiA6IG1pLmluRGF0YS5nZXQoIlNNRkciKQogICAgaU9ORk0gPSAobWkuaW5EYXRhLmdldCgiT05GTSIpID09IG51bGwgfHwgbWkuaW5EYXRhLmdldCgiT05GTSIpLnRyaW0oKS5pc0VtcHR5KCkpID8gIiAiIDogbWkuaW5EYXRhLmdldCgiT05GTSIpCiAgICBpTE1GUyA9IChtaS5pbkRhdGEuZ2V0KCJMTUZTIikgPT0gbnVsbCB8fCBtaS5pbkRhdGEuZ2V0KCJMTUZTIikudHJpbSgpLmlzRW1wdHkoKSkgPyAiIiA6IG1pLmluRGF0YS5nZXQoIkxNRlMiKQogICAgaUxNRkQgPSAobWkuaW5EYXRhLmdldCgiTE1GRCIpID09IG51bGwgfHwgbWkuaW5EYXRhLmdldCgiTE1GRCIpLnRyaW0oKS5pc0VtcHR5KCkpID8gIiIgOiBtaS5pbkRhdGEuZ2V0KCJMTUZEIikKICAgIGlQS0RWID0gKG1pLmluRGF0YS5nZXQoIlBLRFYiKSA9PSBudWxsIHx8IG1pLmluRGF0YS5nZXQoIlBLRFYiKS50cmltKCkuaXNFbXB0eSgpKSA/ICIiIDogbWkuaW5EYXRhLmdldCgiUEtEViIpCiAgICBpUFNEViA9IChtaS5pbkRhdGEuZ2V0KCJQU0RWIikgPT0gbnVsbCB8fCBtaS5pbkRhdGEuZ2V0KCJQU0RWIikudHJpbSgpLmlzRW1wdHkoKSkgPyAiIiA6IG1pLmluRGF0YS5nZXQoIlBTRFYiKQogICAgaVBURFYgPSAobWkuaW5EYXRhLmdldCgiUFREViIpID09IG51bGwgfHwgbWkuaW5EYXRhLmdldCgiUFREViIpLnRyaW0oKS5pc0VtcHR5KCkpID8gIiIgOiBtaS5pbkRhdGEuZ2V0KCJQVERWIikKICAgIGlMTkRWID0gKG1pLmluRGF0YS5nZXQoIkxORFYiKSA9PSBudWxsIHx8IG1pLmluRGF0YS5nZXQoIkxORFYiKS50cmltKCkuaXNFbXB0eSgpKSA/ICIiIDogbWkuaW5EYXRhLmdldCgiTE5EViIpCiAgICBpRkQwMSA9IChtaS5pbkRhdGEuZ2V0KCJGRDAxIikgPT0gbnVsbCB8fCBtaS5pbkRhdGEuZ2V0KCJGRDAxIikudHJpbSgpLmlzRW1wdHkoKSkgPyAiIiA6IG1pLmluRGF0YS5nZXQoIkZEMDEiKQogICAgaUZEMDIgPSAobWkuaW5EYXRhLmdldCgiRkQwMiIpID09IG51bGwgfHwgbWkuaW5EYXRhLmdldCgiRkQwMiIpLnRyaW0oKS5pc0VtcHR5KCkpID8gIiIgOiBtaS5pbkRhdGEuZ2V0KCJGRDAyIikKICAgIGlVRDAxID0gKG1pLmluRGF0YS5nZXQoIlVEMDEiKSA9PSBudWxsIHx8IG1pLmluRGF0YS5nZXQoIlVEMDEiKS50cmltKCkuaXNFbXB0eSgpKSA/ICIiIDogbWkuaW5EYXRhLmdldCgiVUQwMSIpCiAgICBpVUQwMiA9IChtaS5pbkRhdGEuZ2V0KCJVRDAyIikgPT0gbnVsbCB8fCBtaS5pbkRhdGEuZ2V0KCJVRDAyIikudHJpbSgpLmlzRW1wdHkoKSkgPyAiIiA6IG1pLmluRGF0YS5nZXQoIlVEMDIiKQoKICAgIGlDT05PID0gKG1pLmluRGF0YS5nZXQoIkNPTk8iKSA9PSBudWxsIHx8IG1pLmluRGF0YS5nZXQoIkNPTk8iKS50cmltKCkuaXNFbXB0eSgpKSA/IHByb2dyYW0uTERBWkQuQ09OTyBhcyBJbnRlZ2VyIDogbWkuaW5EYXRhLmdldCgiQ09OTyIpIGFzIEludGVnZXIKICAgIGlDSVNOID0gKG1pLmluRGF0YS5nZXQoIkNJU04iKSA9PSBudWxsIHx8IG1pLmluRGF0YS5nZXQoIkNJU04iKS50cmltKCkuaXNFbXB0eSgpKSA/IDAgOiBtaS5pbkRhdGEuZ2V0KCJDSVNOIikgYXMgSW50ZWdlcgogICAgaVRUWVAgPSAobWkuaW5EYXRhLmdldCgiVFRZUCIpID09IG51bGwgfHwgbWkuaW5EYXRhLmdldCgiVFRZUCIpLnRyaW0oKS5pc0VtcHR5KCkpID8gMCA6IG1pLmluRGF0YS5nZXQoIlRUWVAiKSBhcyBJbnRlZ2VyCiAgICBpRExJWCA9IChtaS5pbkRhdGEuZ2V0KCJETElYIikgPT0gbnVsbCB8fCBtaS5pbkRhdGEuZ2V0KCJETElYIikudHJpbSgpLmlzRW1wdHkoKSkgPyAwIDogbWkuaW5EYXRhLmdldCgiRExJWCIpIGFzIExvbmcKICAgIGlCWE5PID0gKG1pLmluRGF0YS5nZXQoIkJYTk8iKSA9PSBudWxsIHx8IG1pLmluRGF0YS5nZXQoIkJYTk8iKS50cmltKCkuaXNFbXB0eSgpKSA/IDAgOiBtaS5pbkRhdGEuZ2V0KCJCWE5PIikgYXMgSW50ZWdlcgogICAgaUVTVFcgPSAobWkuaW5EYXRhLmdldCgiRVNUVyIpID09IG51bGwgfHwgbWkuaW5EYXRhLmdldCgiRVNUVyIpLnRyaW0oKS5pc0VtcHR5KCkpID8gMCA6IG1pLmluRGF0YS5nZXQoIkVTVFciKSBhcyBEb3VibGUKICAgIGlBQ1RXID0gKG1pLmluRGF0YS5nZXQoIkFDVFciKSA9PSBudWxsIHx8IG1pLmluRGF0YS5nZXQoIkFDVFciKS50cmltKCkuaXNFbXB0eSgpKSA/IDAgOiBtaS5pbkRhdGEuZ2V0KCJBQ1RXIikgYXMgRG91YmxlCiAgICBpV0dUTyA9IChtaS5pbkRhdGEuZ2V0KCJXR1RPIikgPT0gbnVsbCB8fCBtaS5pbkRhdGEuZ2V0KCJXR1RPIikudHJpbSgpLmlzRW1wdHkoKSkgPyAwIDogbWkuaW5EYXRhLmdldCgiV0dUTyIpIGFzIEludGVnZXIKICAgIGlVRDAzID0gKG1pLmluRGF0YS5nZXQoIlVEMDMiKSA9PSBudWxsIHx8IG1pLmluRGF0YS5nZXQoIlVEMDMiKS50cmltKCkuaXNFbXB0eSgpKSA/IDAgOiBtaS5pbkRhdGEuZ2V0KCJVRDAzIikgYXMgRG91YmxlCgogICAgdmFsaWRhdGVJbnB1dCgpCiAgICBpZiAodmFsaWRJbnB1dCkgewogICAgICBpbnNlcnRSZWNvcmQoKQogICAgfQogIH0KCiAgLyoqCiAgICpWYWxpZGF0ZSBSZWNvcmRzCiAgICogQHBhcmFtcwogICAqIEByZXR1cm4gCiAgICovCiAgcHVibGljIHZhbGlkYXRlSW5wdXQoKSB7CgogICAgLy9WYWxpZGF0ZSBDb21wYW55IE51bWJlcgogICAgZGVmIHBhcmFtcyA9IFsiQ09OTyI6IGlDT05PLnRvU3RyaW5nKCkudHJpbSgpXQogICAgZGVmIGNhbGxiYWNrID0gewogICAgICBNYXAgPCBTdHJpbmcsCiAgICAgIFN0cmluZyA+IHJlc3BvbnNlIC0+CiAgICAgIGlmIChyZXNwb25zZS5DT05PID09IG51bGwpIHsKICAgICAgICBtaS5lcnJvcigiSW52YWxpZCBDb21wYW55IE51bWJlciAiICsgaUNPTk8pCiAgICAgICAgdmFsaWRJbnB1dCA9IGZhbHNlCiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgIH0KICAgIH0KICAgIG1pQ2FsbGVyLmNhbGwoIk1OUzA5NU1JIiwgIkdldCIsIHBhcmFtcywgY2FsbGJhY2spCgogICAgLy9WYWxpZGF0ZSBPcmRlciBOdW1iZXIKICAgIHBhcmFtcyA9IFsiQ09OTyI6IGlDT05PLnRvU3RyaW5nKCkudHJpbSgpLCAiT1JOTyI6IGlPUk5PLnRvU3RyaW5nKCkudHJpbSgpXQogICAgY2FsbGJhY2sgPSB7CiAgICAgIE1hcCA8IFN0cmluZywKICAgICAgU3RyaW5nID4gcmVzcG9uc2UgLT4KICAgICAgaWYgKHJlc3BvbnNlLk9STk8gPT0gbnVsbCkgewogICAgICAgIG1pLmVycm9yKCJJbnZhbGlkIE9yZGVyIE51bWJlciAiICsgaU9STk8pCiAgICAgICAgdmFsaWRJbnB1dCA9IGZhbHNlCiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgIH0KICAgIH0KICAgIG1pQ2FsbGVyLmNhbGwoIk9JUzEwME1JIiwgIkdldE9yZGVySGVhZCIsIHBhcmFtcywgY2FsbGJhY2spCgogICAgLy9WYWxpZGF0ZSBEZWxpdmVyeSBOdW1iZXIKICAgIHBhcmFtcyA9IFsiQ09OTyI6IGlDT05PLnRvU3RyaW5nKCkudHJpbSgpLCAiRExJWCI6IGlETElYLnRvU3RyaW5nKCkudHJpbSgpXQogICAgY2FsbGJhY2sgPSB7CiAgICAgIE1hcCA8IFN0cmluZywKICAgICAgU3RyaW5nID4gcmVzcG9uc2UgLT4KICAgICAgaWYgKHJlc3BvbnNlLkRMSVggPT0gbnVsbCkgewogICAgICAgIG1pLmVycm9yKCJJbnZhbGlkIERlbGl2ZXJ5IE51bWJlciAiICsgaURMSVgpCiAgICAgICAgdmFsaWRJbnB1dCA9IGZhbHNlCiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgIH0KICAgIH0KICAgIG1pQ2FsbGVyLmNhbGwoIk1XUzQxME1JIiwgIkdldEhlYWQiLCBwYXJhbXMsIGNhbGxiYWNrKQoKICAgIC8vVmFsaWRhdGUgV2FyZWhvdXNlIE51bWJlcgogICAgcGFyYW1zID0gWyJDT05PIjogaUNPTk8udG9TdHJpbmcoKS50cmltKCksICJXSExPIjogaVdITE8udG9TdHJpbmcoKS50cmltKCldCiAgICBjYWxsYmFjayA9IHsKICAgICAgTWFwIDwgU3RyaW5nLAogICAgICBTdHJpbmcgPiByZXNwb25zZSAtPgogICAgICBpZiAocmVzcG9uc2UuV0hMTyA9PSBudWxsKSB7CiAgICAgICAgbWkuZXJyb3IoIkludmFsaWQgV2FyZWhvdXNlIE51bWJlciAiICsgaVdITE8pCiAgICAgICAgdmFsaWRJbnB1dCA9IGZhbHNlCiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgIH0KICAgIH0KICAgIG1pQ2FsbGVyLmNhbGwoIk1NUzAwNU1JIiwgIkdldFdhcmVob3VzZSIsIHBhcmFtcywgY2FsbGJhY2spCgogICAgaWYgKCFpRkFDSS50cmltKCkuaXNFbXB0eSgpKSB7CiAgICAgIC8vVmFsaWRhdGUgRmFjaWxpdHkgTnVtYmVyIAogICAgICBwYXJhbXMgPSBbIkNPTk8iOiBpQ09OTy50b1N0cmluZygpLnRyaW0oKSwgIkZBQ0kiOiBpRkFDSS50b1N0cmluZygpLnRyaW0oKV0KICAgICAgY2FsbGJhY2sgPSB7CiAgICAgICAgTWFwIDwgU3RyaW5nLAogICAgICAgIFN0cmluZyA+IHJlc3BvbnNlIC0+CiAgICAgICAgaWYgKHJlc3BvbnNlLkZBQ0kgPT0gbnVsbCkgewogICAgICAgICAgbWkuZXJyb3IoIkludmFsaWQgRmFjaWxpdHkgICIgKyBpRkFDSSkKICAgICAgICAgIHZhbGlkSW5wdXQgPSBmYWxzZQogICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgfQogICAgICB9CiAgICAgIG1pQ2FsbGVyLmNhbGwoIkNSUzAwOE1JIiwgIkdldCIsIHBhcmFtcywgY2FsbGJhY2spCiAgICB9CgogICAgaWYgKCFpQ1VOTy50cmltKCkuaXNFbXB0eSgpKSB7CiAgICAgIC8vVmFsaWRhdGUgQ3VzdG9tZXIgTnVtYmVyCiAgICAgIHBhcmFtcyA9IFsiQ1VOTyI6IGlDVU5PLnRvU3RyaW5nKCkudHJpbSgpXQogICAgICBjYWxsYmFjayA9IHsKICAgICAgICBNYXAgPCBTdHJpbmcsCiAgICAgICAgU3RyaW5nID4gcmVzcG9uc2UgLT4KICAgICAgICBpZiAocmVzcG9uc2UuQ1VOTyA9PSBudWxsKSB7CiAgICAgICAgICBtaS5lcnJvcigiSW52YWxpZCBDdXN0b21lciBOdW1iZXIgIiArIGlDVU5PKQogICAgICAgICAgdmFsaWRJbnB1dCA9IGZhbHNlCiAgICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgICB9CiAgICAgIH0KICAgICAgbWlDYWxsZXIuY2FsbCgiQ1JTNjEwTUkiLCAiR2V0QmFzaWNEYXRhIiwgcGFyYW1zLCBjYWxsYmFjaykKICAgIH0KCiAgICBpZiAoIWlNT0RMLnRyaW0oKS5pc0VtcHR5KCkpIHsKICAgICAgLy9WYWxpZGF0ZSBEZWxpdmVyeSBNZXRob2QKICAgICAgcGFyYW1zID0gWyJNT0RMIjogaU1PREwudG9TdHJpbmcoKS50cmltKCksICJMTkNEIjogIkdCIl0KICAgICAgY2FsbGJhY2sgPSB7CiAgICAgICAgTWFwIDwgU3RyaW5nLAogICAgICAgIFN0cmluZyA+IHJlc3BvbnNlIC0+CiAgICAgICAgaWYgKHJlc3BvbnNlLk1PREwgPT0gbnVsbCkgewogICAgICAgICAgbWkuZXJyb3IoIkludmFsaWQgRGVsaXZlcnkgTWV0aG9kICIgKyBpTU9ETCkKICAgICAgICAgIHZhbGlkSW5wdXQgPSBmYWxzZQogICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgfQogICAgICB9CiAgICAgIG1pQ2FsbGVyLmNhbGwoIkNSUzA3ME1JIiwgIkdldERlbHlNZXRob2QiLCBwYXJhbXMsIGNhbGxiYWNrKQogICAgfQoKICAgIGlmICghaVRFUEEudHJpbSgpLmlzRW1wdHkoKSkgewogICAgICAvL1BhY2thZ2luZyBUZXJtcwogICAgICBEQkFjdGlvbiBhY3Rpb24gPSBkYXRhYmFzZS50YWJsZSgiQ1NZVEFCIikuaW5kZXgoIjAwIikuYnVpbGQoKQogICAgICBEQkNvbnRhaW5lciBxdWVyeSA9IGFjdGlvbi5nZXRDb250YWluZXIoKQogICAgICBxdWVyeS5zZXQoIkNUQ09OTyIsIGlDT05PKQogICAgICBxdWVyeS5zZXQoIkNURElWSSIsICIiKQogICAgICBxdWVyeS5zZXQoIkNUU1RDTyIsICJURVBBIikKICAgICAgcXVlcnkuc2V0KCJDVFNUS1kiLCBpVEVQQSkKICAgICAgcXVlcnkuc2V0KCJDVExOQ0QiLCAiR0IiKQogICAgICBpZiAoIWFjdGlvbi5yZWFkKHF1ZXJ5KSkgewogICAgICAgIG1pLmVycm9yKCJJbnZhbGlkIFBhY2thZ2luZyBUZXJtczogIiArIGlURVBBKQogICAgICAgIHJldHVybiBmYWxzZQogICAgICB9CiAgICB9CgogICAgaWYgKCFpVEVQWS50cmltKCkuaXNFbXB0eSgpKSB7CiAgICAgIC8vIFBheW1lbnQgVGVybXMKICAgICAgREJBY3Rpb24gYWN0aW9uID0gZGF0YWJhc2UudGFibGUoIkNTWVRBQiIpLmluZGV4KCIwMCIpLmJ1aWxkKCkKICAgICAgREJDb250YWluZXIgcXVlcnkgPSBhY3Rpb24uZ2V0Q29udGFpbmVyKCkKICAgICAgcXVlcnkuc2V0KCJDVENPTk8iLCBpQ09OTykKICAgICAgcXVlcnkuc2V0KCJDVERJVkkiLCAiIikKICAgICAgcXVlcnkuc2V0KCJDVFNUQ08iLCAiVEVQWSIpCiAgICAgIHF1ZXJ5LnNldCgiQ1RTVEtZIiwgaVRFUFkpCiAgICAgIHF1ZXJ5LnNldCgiQ1RMTkNEIiwgIkdCIikKICAgICAgaWYgKCFhY3Rpb24ucmVhZChxdWVyeSkpIHsKICAgICAgICBtaS5lcnJvcigiSW52YWxpZCBQYXltZW50IFRlcm1zOiAiICsgaVRFUFkpCiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgIH0KICAgIH0KCiAgfQogIC8qKgogICAqSW5zZXJ0IHJlY29yZHMgdG8gRVhUTkJOIHRhYmxlCiAgICogQHBhcmFtcyAKICAgKiBAcmV0dXJuIAogICAqLwogIHB1YmxpYyBpbnNlcnRSZWNvcmQoKSB7CiAgICBEQkFjdGlvbiBhY3Rpb24gPSBkYXRhYmFzZS50YWJsZSgiRVhUTkJOIikuaW5kZXgoIjAwIikuYnVpbGQoKQogICAgREJDb250YWluZXIgcXVlcnkgPSBhY3Rpb24uZ2V0Q29udGFpbmVyKCkKICAgIHF1ZXJ5LnNldCgiRVhESVZJIiwgaURJVkkpCiAgICBxdWVyeS5zZXQoIkVYV0hMTyIsIGlXSExPKQogICAgcXVlcnkuc2V0KCJFWEZBQ0kiLCBpRkFDSSkKICAgIHF1ZXJ5LnNldCgiRVhSQ0lEIiwgaVJDSUQpCiAgICBxdWVyeS5zZXQoIkVYTElDUCIsIGlMSUNQKQogICAgcXVlcnkuc2V0KCJFWE9STk8iLCBpT1JOTykKICAgIHF1ZXJ5LnNldCgiRVhTVEFUIiwgaVNUQVQpCiAgICBxdWVyeS5zZXQoIkVYQ1VOTyIsIGlDVU5PKQogICAgcXVlcnkuc2V0KCJFWE1PREwiLCBpTU9ETCkKICAgIHF1ZXJ5LnNldCgiRVhURVBZIiwgaVRFUFkpCiAgICBxdWVyeS5zZXQoIkVYVEVQQSIsIGlURVBBKQogICAgcXVlcnkuc2V0KCJFWFdHRkciLCBpV0dGRykKICAgIHF1ZXJ5LnNldCgiRVhRQUZHIiwgaVFBRkcpCiAgICBxdWVyeS5zZXQoIkVYU01GRyIsIGlTTUZHKQogICAgcXVlcnkuc2V0KCJFWE9ORk0iLCBpT05GTSkKICAgIHF1ZXJ5LnNldCgiRVhMTUZTIiwgaUxNRlMpCiAgICBxdWVyeS5zZXQoIkVYTE1GRCIsIGlMTUZEKQogICAgcXVlcnkuc2V0KCJFWFBLRFYiLCBpUEtEVikKICAgIHF1ZXJ5LnNldCgiRVhQU0RWIiwgaVBTRFYpCiAgICBxdWVyeS5zZXQoIkVYUFREViIsIGlQVERWKQogICAgcXVlcnkuc2V0KCJFWExORFYiLCBpTE5EVikKICAgIHF1ZXJ5LnNldCgiRVhGRDAxIiwgaUZEMDEpCiAgICBxdWVyeS5zZXQoIkVYRkQwMiIsIGlGRDAyKQogICAgcXVlcnkuc2V0KCJFWFVEMDEiLCBpVUQwMSkKICAgIHF1ZXJ5LnNldCgiRVhVRDAyIiwgaVVEMDIpCiAgICBxdWVyeS5zZXQoIkVYQ09OTyIsIGlDT05PIGFzIEludGVnZXIpCiAgICBxdWVyeS5zZXQoIkVYQ0lTTiIsIGlDSVNOIGFzIEludGVnZXIpCiAgICBxdWVyeS5zZXQoIkVYVFRZUCIsIGlUVFlQIGFzIEludGVnZXIpCiAgICBxdWVyeS5zZXQoIkVYRExJWCIsIGlETElYIGFzIExvbmcpCiAgICBxdWVyeS5zZXQoIkVYQlhOTyIsIGlCWE5PIGFzIEludGVnZXIpCiAgICBxdWVyeS5zZXQoIkVYRVNUVyIsIGlFU1RXIGFzIERvdWJsZSkKICAgIHF1ZXJ5LnNldCgiRVhBQ1RXIiwgaUFDVFcgYXMgRG91YmxlKQogICAgcXVlcnkuc2V0KCJFWFdHVE8iLCBpV0dUTyBhcyBJbnRlZ2VyKQogICAgcXVlcnkuc2V0KCJFWFVEMDMiLCBpVUQwMyBhcyBEb3VibGUpCiAgICBxdWVyeS5zZXQoIkVYUkdEVCIsIExvY2FsRGF0ZVRpbWUubm93KCkuZm9ybWF0KERhdGVUaW1lRm9ybWF0dGVyLm9mUGF0dGVybigieXl5eU1NZGQiKSkudG9JbnRlZ2VyKCkpCiAgICBxdWVyeS5zZXQoIkVYUkdUTSIsIExvY2FsRGF0ZVRpbWUubm93KCkuZm9ybWF0KERhdGVUaW1lRm9ybWF0dGVyLm9mUGF0dGVybigiSEhtbXNzIikpLnRvSW50ZWdlcigpKQogICAgcXVlcnkuc2V0KCJFWExNRFQiLCBMb2NhbERhdGVUaW1lLm5vdygpLmZvcm1hdChEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oInl5eXlNTWRkIikpLnRvSW50ZWdlcigpKQogICAgcXVlcnkuc2V0KCJFWExNVE0iLCBMb2NhbERhdGVUaW1lLm5vdygpLmZvcm1hdChEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oIkhIbW1zcyIpKS50b0ludGVnZXIoKSkKICAgIHF1ZXJ5LnNldCgiRVhDSE5PIiwgMCkKICAgIHF1ZXJ5LnNldCgiRVhDSElEIiwgcHJvZ3JhbS5nZXRVc2VyKCkpCiAgICBhY3Rpb24uaW5zZXJ0KHF1ZXJ5LCByZWNvcmRFeGlzdHMpCiAgfQoKICBDbG9zdXJlIHJlY29yZEV4aXN0cyA9IHsKICAgIG1pLmVycm9yKCJSZWNvcmQgQWxyZWFkeSBFeGlzdHMiKQogICAgcmV0dXJuCiAgfQp9"}}}